<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#0C7C6D">
    <meta name="description" content="Assess and purify your spiritual heart with wisdom from classical Islamic scholars">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Qalb">
    
    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="icon-32.png">
    <link rel="apple-touch-icon" sizes="180x180" href="icon-192.png">
    
    <!-- Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <title>Qalb - Spiritual Heart Health Assessment</title>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600;700&family=Inter:wght@300;400;500;600&family=Noto+Nastaliq+Urdu:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #0C7C6D;
            --primary-light: #14A895;
            --primary-dark: #064E45;
            --gold: #D4AF37;
            --cream: #FBF8F3;
            --text: #1A1A1A;
            --text-light: #666;
            --white: #FFFFFF;
            --danger: #C53030;
            --warning: #DD6B20;
            --success: #38A169;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--cream) 0%, #E8E4DD 100%);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(12, 124, 109, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(212, 175, 55, 0.03) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 60px;
            animation: fadeInDown 0.8s ease-out;
        }
        
        .logo {
            font-family: 'Cormorant Garamond', serif;
            font-size: 3rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 10px;
            letter-spacing: 2px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            color: var(--text-light);
            font-weight: 300;
            letter-spacing: 1px;
        }
        
        .arabic-subtitle {
            font-size: 1.5rem;
            color: var(--gold);
            margin-top: 15px;
            font-weight: 400;
        }
        
        .card {
            background: var(--white);
            border-radius: 24px;
            padding: 50px 60px;
            box-shadow: 
                0 10px 40px rgba(0,0,0,0.06),
                0 0 0 1px rgba(12, 124, 109, 0.05);
            animation: fadeInUp 0.8s ease-out;
            position: relative;
            overflow: hidden;
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--gold), var(--primary));
            animation: shimmer 3s infinite;
        }
        
        @keyframes shimmer {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }
        
        h2 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 2.2rem;
            color: var(--primary-dark);
            margin-bottom: 30px;
            text-align: center;
        }
        
        .intro-text {
            text-align: center;
            margin-bottom: 40px;
            color: var(--text-light);
            line-height: 1.8;
            font-size: 1.05rem;
        }
        
        .bismillah {
            text-align: center;
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 30px;
            font-weight: 400;
        }
        
        .question {
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 1px solid rgba(12, 124, 109, 0.1);
            animation: fadeIn 0.5s ease-out;
        }
        
        .question:last-child {
            border-bottom: none;
        }
        
        .question-text {
            font-size: 1.15rem;
            color: var(--text);
            margin-bottom: 20px;
            line-height: 1.6;
            font-weight: 500;
        }
        
        .question-number {
            display: inline-block;
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 32px;
            margin-right: 12px;
            font-size: 0.9rem;
            font-weight: 600;
        }
        
        .scenario {
            background: linear-gradient(135deg, rgba(12, 124, 109, 0.05), rgba(212, 175, 55, 0.05));
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            font-style: italic;
            border-left: 4px solid var(--gold);
        }
        
        .options {
            margin-top: 20px;
        }
        
        .option {
            background: white;
            border: 2px solid rgba(12, 124, 109, 0.2);
            border-radius: 12px;
            padding: 15px 20px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
        }
        
        .option:hover {
            border-color: var(--primary);
            background: rgba(12, 124, 109, 0.05);
            transform: translateX(5px);
        }
        
        .option.selected {
            border-color: var(--primary);
            background: linear-gradient(135deg, rgba(12, 124, 109, 0.1), rgba(212, 175, 55, 0.1));
            font-weight: 600;
        }
        
        .option-letter {
            display: inline-block;
            width: 28px;
            height: 28px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 28px;
            margin-right: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            flex-shrink: 0;
        }
        
        .option.selected .option-letter {
            background: linear-gradient(135deg, var(--primary), var(--gold));
        }
        
        .slider-container {
            padding: 20px 0;
        }
        
        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-size: 0.9rem;
            color: var(--text-light);
        }
        
        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 10px;
            background: linear-gradient(to right, 
                var(--success) 0%, 
                var(--warning) 50%, 
                var(--danger) 100%);
            outline: none;
            -webkit-appearance: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: white;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            border: 3px solid var(--primary);
            transition: transform 0.2s;
        }
        
        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }
        
        input[type="range"]::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: white;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            border: 3px solid var(--primary);
        }
        
        .slider-value {
            text-align: center;
            margin-top: 10px;
            font-weight: 600;
            color: var(--primary);
            font-size: 1.1rem;
        }
        
        .progress-container {
            margin: 30px 0;
            background: rgba(12, 124, 109, 0.1);
            height: 6px;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--primary-light));
            transition: width 0.5s ease;
            border-radius: 10px;
        }
        
        .progress-text {
            text-align: center;
            margin-top: 10px;
            color: var(--text-light);
            font-size: 0.95rem;
        }
        
        .btn {
            display: inline-block;
            padding: 16px 40px;
            border-radius: 12px;
            font-size: 1.05rem;
            font-weight: 600;
            text-align: center;
            cursor: pointer;
            border: none;
            transition: all 0.3s ease;
            font-family: 'Inter', sans-serif;
            letter-spacing: 0.5px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            box-shadow: 0 4px 15px rgba(12, 124, 109, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(12, 124, 109, 0.4);
        }
        
        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-secondary {
            background: white;
            color: var(--primary);
            border: 2px solid var(--primary);
            margin-right: 15px;
        }
        
        .btn-secondary:hover {
            background: var(--primary);
            color: white;
        }
        
        .button-group {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 40px;
        }
        
        .results-header {
            text-align: center;
            margin-bottom: 50px;
        }
        
        .health-score {
            font-size: 5rem;
            font-weight: 700;
            font-family: 'Cormorant Garamond', serif;
            margin: 20px 0;
            background: linear-gradient(135deg, var(--primary), var(--gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .health-label {
            font-size: 1.5rem;
            color: var(--text-light);
            font-weight: 300;
            margin-bottom: 10px;
        }
        
        .heart-icon {
            font-size: 4rem;
            margin: 20px 0;
            animation: heartbeat 1.5s infinite;
        }
        
        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }
        
        .category-card {
            background: linear-gradient(135deg, var(--white) 0%, var(--cream) 100%);
            border-radius: 16px;
            padding: 25px;
            border: 1px solid rgba(12, 124, 109, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .category-name {
            font-weight: 600;
            color: var(--primary-dark);
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        .category-score {
            font-size: 2rem;
            font-weight: 700;
            font-family: 'Cormorant Garamond', serif;
            margin: 10px 0;
        }
        
        .category-status {
            font-size: 0.9rem;
            font-weight: 500;
            padding: 6px 12px;
            border-radius: 20px;
            display: inline-block;
            margin-top: 10px;
        }
        
        .status-excellent { background: var(--success); color: white; }
        .status-good { background: var(--primary); color: white; }
        .status-concerning { background: var(--warning); color: white; }
        .status-critical { background: var(--danger); color: white; }
        
        .prescription {
            background: linear-gradient(135deg, var(--white) 0%, var(--cream) 100%);
            border-radius: 20px;
            padding: 35px;
            margin-bottom: 30px;
            border-left: 6px solid var(--gold);
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            animation: slideIn 0.6s ease-out;
            animation-fill-mode: both;
        }
        
        .prescription:nth-child(1) { animation-delay: 0.1s; }
        .prescription:nth-child(2) { animation-delay: 0.2s; }
        .prescription:nth-child(3) { animation-delay: 0.3s; }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .prescription-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(212, 175, 55, 0.2);
        }
        
        .prescription-icon {
            font-size: 2.5rem;
            margin-right: 15px;
        }
        
        .prescription-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.8rem;
            color: var(--primary-dark);
            font-weight: 700;
        }
        
        .prescription-arabic {
            color: var(--gold);
            font-size: 1.3rem;
            margin-top: 5px;
        }
        
        .prescription-section {
            margin: 20px 0;
        }
        
        .prescription-section-title {
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .prescription-content {
            color: var(--text);
            line-height: 1.8;
            font-size: 1.05rem;
        }
        
        .power-reminder {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
            font-style: italic;
            font-size: 1.1rem;
            line-height: 1.6;
            box-shadow: 0 4px 15px rgba(12, 124, 109, 0.2);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .hidden {
            display: none;
        }
        
        @media (max-width: 768px) {
            .card {
                padding: 30px 25px;
            }
            
            .logo {
                font-size: 2.2rem;
            }
            
            h2 {
                font-size: 1.8rem;
            }
            
            .health-score {
                font-size: 3.5rem;
            }
            
            .categories-grid {
                grid-template-columns: 1fr;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                margin: 5px 0 !important;
            }
        }
        
        .phase-transition {
            text-align: center;
            padding: 40px;
            animation: fadeIn 1s ease;
        }
        
        .phase-transition h3 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 20px;
        }
        
        .phase-transition p {
            color: var(--text-light);
            font-size: 1.1rem;
            line-height: 1.8;
            margin-bottom: 15px;
        }
        
        .flagged-categories {
            margin: 30px 0;
        }
        
        .flagged-category-badge {
            display: inline-block;
            background: linear-gradient(135deg, var(--warning), var(--danger));
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            margin: 5px;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <!-- URDU TOGGLE BUTTON -->
    <div style="position: fixed; top: 10px; right: 10px; z-index: 999999;">
        <button id="urduBtn" style="background: #0C7C6D; color: white; border: 2px solid white; padding: 15px 30px; border-radius: 30px; font-size: 18px; font-weight: bold; cursor: pointer; box-shadow: 0 5px 20px rgba(0,0,0,0.3);">
            ÿßÿ±ÿØŸà
        </button>
    </div>
    
    <div class="container">
        <header>
            <div class="logo">QALB</div>
            <div class="subtitle">Spiritual Heart Health Assessment</div>
            <div class="arabic-subtitle">ÿ™ŸÇŸäŸäŸÖ ÿµÿ≠ÿ© ÿßŸÑŸÇŸÑÿ® ÿßŸÑÿ±Ÿàÿ≠Ÿä</div>
        </header>

        <!-- Welcome Screen -->
        <div id="welcome-screen" class="card">
            <div class="bismillah">ÿ®Ÿêÿ≥ŸíŸÖŸê ÿßŸÑŸÑŸáŸê ÿßŸÑÿ±ŸéŸëÿ≠ŸíŸÖŸ∞ŸÜŸê ÿßŸÑÿ±ŸéŸëÿ≠ŸêŸäŸíŸÖŸê</div>
            <h2 id="welcome-title">Discover the State of Your Heart</h2>
            <div class="intro-text">
                <p style="margin-bottom: 20px;" id="hadith-text">
                    "Indeed, there is in the body a piece of flesh which, if sound, the entire body is sound, 
                    and if corrupt, the entire body is corrupt. Verily, it is the heart."
                    <br><em style="color: var(--gold);">‚Äî Prophet Muhammad Ô∑∫</em>
                </p>
                <p style="margin-bottom: 20px;" id="description-text">
                    This adaptive assessment uses <strong>real-life scenarios</strong> combined with the wisdom of 
                    <strong>Ahmad Zarruq</strong> and <strong>Imam Mawlud</strong> to help you identify and treat spiritual diseases.
                </p>
                <p style="color: var(--primary); font-weight: 500;" id="phases-text">
                    Phase 1: 18 situational questions (~10 minutes)<br>
                    Phase 2: Adaptive deep dive if needed (~10 more minutes)<br>
                    Privacy: Your answers stay private on your device
                </p>
            </div>
            <div class="button-group">
                <button class="btn btn-primary" id="begin-btn" onclick="startAssessment()">Begin Assessment</button>
            </div>
        </div>

        <!-- Phase 1: Category Screening -->
        <div id="phase1-screen" class="card hidden">
            <h2>Phase 1: Situational Screening</h2>
            <div class="progress-container">
                <div id="progress-bar-phase1" class="progress-bar" style="width: 0%"></div>
            </div>
            <div class="progress-text" id="progress-text-phase1">Question 1 of 18</div>
            
            <div id="questions-phase1"></div>
            
            <div class="button-group">
                <button class="btn btn-secondary" onclick="goBackPhase1()" id="back-btn-phase1" style="display:none;">Back</button>
                <button class="btn btn-primary" onclick="nextPhase1()" id="next-btn-phase1" disabled>Next</button>
            </div>
        </div>

        <!-- Phase Transition -->
        <div id="transition-screen" class="card hidden">
            <div class="phase-transition">
                <h3>üìä Phase 1 Complete!</h3>
                <p>Based on your responses, we've identified some areas that need deeper attention:</p>
                <div class="flagged-categories" id="flagged-list"></div>
                <p style="margin-top: 30px;">Phase 2 will ask <strong>5 targeted questions</strong> for each flagged area to identify specific diseases and provide precise prescriptions.</p>
                <p style="color: var(--gold); font-weight: 600;">This will take approximately 10 more minutes.</p>
            </div>
            <div class="button-group">
                <button class="btn btn-primary" onclick="startPhase2()">Continue to Phase 2</button>
            </div>
        </div>

        <!-- Phase 2: Deep Dive -->
        <div id="phase2-screen" class="card hidden">
            <h2>Phase 2: Deep Dive Assessment</h2>
            <div class="progress-container">
                <div id="progress-bar-phase2" class="progress-bar" style="width: 0%"></div>
            </div>
            <div class="progress-text" id="progress-text-phase2"></div>
            
            <div id="questions-phase2"></div>
            
            <div class="button-group">
                <button class="btn btn-secondary" onclick="goBackPhase2()">Back</button>
                <button class="btn btn-primary" onclick="nextPhase2()" id="next-btn-phase2" disabled>Next</button>
            </div>
        </div>

        <!-- Results Screen -->
        <div id="results-screen" class="card hidden">
            <div class="results-header">
                <h2>Your Spiritual Heart Health Report</h2>
                <div class="health-label">Overall Heart Health</div>
                <div class="health-score" id="overall-score">85%</div>
                <div class="heart-icon">‚ù§Ô∏è</div>
                <div id="health-description" style="color: var(--text-light); font-size: 1.1rem; margin-top: 10px;"></div>
            </div>

            <h3 style="font-family: 'Cormorant Garamond', serif; font-size: 1.8rem; color: var(--primary-dark); margin: 40px 0 20px 0; text-align: center;">
                Category Breakdown
            </h3>
            <div id="categories-results" class="categories-grid"></div>

            <h3 style="font-family: 'Cormorant Garamond', serif; font-size: 1.8rem; color: var(--primary-dark); margin: 60px 0 30px 0; text-align: center;">
                Your Personalized Prescriptions
            </h3>
            <div id="prescriptions-container"></div>

            <div class="button-group" style="margin-top: 50px;">
                <button class="btn btn-secondary" onclick="retakeAssessment()">Retake Assessment</button>
                <button class="btn btn-primary" onclick="saveResults()">Save Results</button>
            </div>
        </div>
    </div>

    <!-- Install PWA Banner -->
    <div id="install-banner" style="display: none; position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: linear-gradient(135deg, #0C7C6D, #14A895); color: white; padding: 15px 25px; border-radius: 50px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); z-index: 10000; animation: slideUp 0.5s ease;">
        <div style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap; justify-content: center;">
            <span style="font-weight: 600;">üì± Install Qalb App!</span>
            <button onclick="installPWA()" style="background: white; color: #0C7C6D; border: none; padding: 8px 20px; border-radius: 25px; font-weight: 600; cursor: pointer;">Install</button>
            <button onclick="dismissInstallBanner()" style="background: transparent; color: white; border: 2px solid white; padding: 8px 20px; border-radius: 25px; font-weight: 600; cursor: pointer;">Later</button>
        </div>
    </div>

    <style>
        @keyframes slideUp {
            from { transform: translateX(-50%) translateY(100px); opacity: 0; }
            to { transform: translateX(-50%) translateY(0); opacity: 1; }
        }
        @media (max-width: 768px) {
            #install-banner { left: 10px; right: 10px; transform: none; width: auto; }
            #install-banner > div { flex-direction: column; gap: 10px; }
        }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script>
        // QUESTION DATABASE
        const PHASE1_QUESTIONS = [
            // Category 1: Wealth (Q1-3)
            {
                id: 1,
                category: 'wealth',
                type: 'multiple',
                scenario: 'You receive your salary and see an urgent appeal for people suffering in Gaza. What do you normally do?',
                options: [
                    { letter: 'A', text: 'Skip it immediately', score: 4 },
                    { letter: 'B', text: "Think 'I'll donate later' but usually forget", score: 3 },
                    { letter: 'C', text: 'Feel frustrated by these constant appeals', score: 3 },
                    { letter: 'D', text: "Feel guilty but don't act", score: 2 },
                    { letter: 'E', text: 'Donate something, even if small', score: 1 },
                    { letter: 'F', text: 'Go directly and give charity with gratitude', score: 0 }
                ]
            },
            {
                id: 2,
                category: 'wealth',
                type: 'multiple',
                scenario: "You're at a restaurant with friends. The bill comes and it's higher than expected. Your first thought is:",
                options: [
                    { letter: 'A', text: 'Worry about your bank balance even though you can afford it', score: 4 },
                    { letter: 'B', text: 'Calculate exactly your share to avoid paying extra', score: 3 },
                    { letter: 'C', text: 'Frustrated you have to spend this much', score: 3 },
                    { letter: 'D', text: 'Fine with it but hope someone else offers to pay', score: 2 },
                    { letter: 'E', text: 'Split it fairly without stress', score: 1 },
                    { letter: 'F', text: 'Offer to pay for everyone as sadaqah', score: 0 }
                ]
            },
            {
                id: 3,
                category: 'wealth',
                type: 'multiple',
                scenario: 'A colleague shows you their new car/phone/house. Your immediate reaction is:',
                options: [
                    { letter: 'A', text: 'Intensely wish you had it instead', score: 4 },
                    { letter: 'B', text: 'Calculate how you can afford the same', score: 4 },
                    { letter: 'C', text: 'Feel inadequate about what you have', score: 3 },
                    { letter: 'D', text: "Wonder why they have it and you don't", score: 3 },
                    { letter: 'E', text: 'Happy for them, neutral about yourself', score: 1 },
                    { letter: 'F', text: 'Happy for them, grateful for what you have', score: 0 }
                ]
            },
            // Category 2: Self (Q4-6)
            {
                id: 4,
                category: 'self',
                type: 'multiple',
                scenario: 'Someone points out a mistake you made publicly. Your instant reaction is:',
                options: [
                    { letter: 'A', text: "Become defensive and argue why you're right", score: 4 },
                    { letter: 'B', text: 'Make excuses or blame circumstances', score: 3 },
                    { letter: 'C', text: 'Feel embarrassed and get angry inside', score: 3 },
                    { letter: 'D', text: 'Dismiss it quietly but hold grudge', score: 2 },
                    { letter: 'E', text: 'Feel bad but accept it', score: 1 },
                    { letter: 'F', text: 'Thank them and immediately correct it', score: 0 }
                ]
            },
            {
                id: 5,
                category: 'self',
                type: 'multiple',
                scenario: 'You help someone significantly but nobody knows about it. How do you feel?',
                options: [
                    { letter: 'A', text: 'Frustrated that no one saw it', score: 4 },
                    { letter: 'B', text: "Tempted to mention it 'casually' to others", score: 3 },
                    { letter: 'C', text: 'Hope they at least tell others about it', score: 3 },
                    { letter: 'D', text: 'Wish someone had witnessed it', score: 2 },
                    { letter: 'E', text: 'Content, though slight wish for recognition', score: 1 },
                    { letter: 'F', text: 'Pure satisfaction between you and Allah', score: 0 }
                ]
            },
            {
                id: 6,
                category: 'self',
                type: 'multiple',
                scenario: "You're mistreated by a security guard/cleaner/service worker for no reason. What do you do?",
                options: [
                    { letter: 'A', text: 'Use your position/power to retaliate', score: 4 },
                    { letter: 'B', text: 'Complain to their superior to get them in trouble', score: 3 },
                    { letter: 'C', text: 'Argue and make them feel small', score: 3 },
                    { letter: 'D', text: 'Feel angry, complain to friends later', score: 2 },
                    { letter: 'E', text: 'Let it go, but feel upset inside', score: 1 },
                    { letter: 'F', text: 'Respond with patience and kindness', score: 0 }
                ]
            },
            // Category 3: Relationships (Q7-9)
            {
                id: 7,
                category: 'relationships',
                type: 'multiple',
                scenario: 'Your friend calls excitedly - they got a job with 4x your salary. Your instant gut feeling is:',
                options: [
                    { letter: 'A', text: 'Why do they get it and not me?', score: 4 },
                    { letter: 'B', text: "Wishing they'd lose it somehow", score: 4 },
                    { letter: 'C', text: "Complaining to Allah 'Why not me?'", score: 3 },
                    { letter: 'D', text: 'Happy for them but bitter inside', score: 3 },
                    { letter: 'E', text: 'Happy but comparing yourself', score: 2 },
                    { letter: 'F', text: "Genuinely happy and make du'a for them", score: 0 }
                ]
            },
            {
                id: 8,
                category: 'relationships',
                type: 'multiple',
                scenario: 'Someone wronged you badly 2 years ago. They never apologized. You run into them today. Your reaction:',
                options: [
                    { letter: 'A', text: 'Ignore them completely, hold the grudge', score: 4 },
                    { letter: 'B', text: 'Be cold and make them feel your anger', score: 3 },
                    { letter: 'C', text: 'Replay what they did and get angry again', score: 3 },
                    { letter: 'D', text: 'Polite but secretly hope they suffer', score: 2 },
                    { letter: 'E', text: 'Civil but not warm', score: 1 },
                    { letter: 'F', text: 'Greet warmly, already forgiven them', score: 0 }
                ]
            },
            {
                id: 9,
                category: 'relationships',
                type: 'multiple',
                scenario: "Friends are talking about someone's mistakes/scandals. You:",
                options: [
                    { letter: 'A', text: 'Jump in with more details you know', score: 4 },
                    { letter: 'B', text: 'Listen intently and enjoy the story', score: 3 },
                    { letter: 'C', text: 'Stay quiet but interested', score: 2 },
                    { letter: 'D', text: "Feel uncomfortable but don't say anything", score: 2 },
                    { letter: 'E', text: 'Change subject subtly', score: 1 },
                    { letter: 'F', text: 'Stop it immediately or leave', score: 0 }
                ]
            },
            // Category 4: Desires (Q10-12)
            {
                id: 10,
                category: 'desires',
                type: 'multiple',
                scenario: "You're alone with your phone/computer. Temptation to watch something inappropriate arises. You:",
                options: [
                    { letter: 'A', text: 'Give in immediately without resistance', score: 4 },
                    { letter: 'B', text: 'Try to resist but usually fail', score: 3 },
                    { letter: 'C', text: 'Struggle but eventually give in', score: 3 },
                    { letter: 'D', text: 'Resist but keep thinking about it', score: 2 },
                    { letter: 'E', text: 'Distract yourself successfully most times', score: 1 },
                    { letter: 'F', text: 'Immediately close/avoid and seek refuge in Allah', score: 0 }
                ]
            },
            {
                id: 11,
                category: 'desires',
                type: 'multiple',
                scenario: "It's Fajr time. Your alarm goes off. Bed is warm and comfortable. You:",
                options: [
                    { letter: 'A', text: 'Turn off alarm, sleep through', score: 4 },
                    { letter: 'B', text: 'Snooze repeatedly, miss it usually', score: 3 },
                    { letter: 'C', text: 'Internal battle, miss it 50% of time', score: 3 },
                    { letter: 'D', text: 'Force yourself up but feel resentful', score: 2 },
                    { letter: 'E', text: 'Get up but struggle every time', score: 1 },
                    { letter: 'F', text: 'Jump up immediately with gratitude', score: 0 }
                ]
            },
            {
                id: 12,
                category: 'desires',
                type: 'multiple',
                scenario: 'Someone mentions death or you see a funeral. Your immediate reaction is:',
                options: [
                    { letter: 'A', text: 'Actively avoid thinking about it', score: 4 },
                    { letter: 'B', text: 'Get anxious and change the subject', score: 3 },
                    { letter: 'C', text: 'Uncomfortable, try to distract yourself', score: 3 },
                    { letter: 'D', text: 'Brief moment of reflection then forget', score: 2 },
                    { letter: 'E', text: 'Reflect but then return to normal', score: 1 },
                    { letter: 'F', text: 'Deep reflection and check your actions', score: 0 }
                ]
            },
            // Category 5: Allah (Q13-15)
            {
                id: 13,
                category: 'allah',
                type: 'multiple',
                scenario: "You're in the middle of Salah. Your mind:",
                options: [
                    { letter: 'A', text: "Completely elsewhere, barely aware you're praying", score: 4 },
                    { letter: 'B', text: 'Mostly thinking about dunya matters', score: 3 },
                    { letter: 'C', text: 'Trying to focus but constantly distracted', score: 2 },
                    { letter: 'D', text: 'Some presence, some distraction', score: 2 },
                    { letter: 'E', text: 'Mostly present with occasional drift', score: 1 },
                    { letter: 'F', text: 'Fully present with Allah', score: 0 }
                ]
            },
            {
                id: 14,
                category: 'allah',
                type: 'multiple',
                scenario: 'You face a major setback - job loss, illness, or rejection. Your first thought is:',
                options: [
                    { letter: 'A', text: 'Why is Allah doing this to me?', score: 4 },
                    { letter: 'B', text: "I don't deserve this, Allah is unfair", score: 4 },
                    { letter: 'C', text: 'What did I do to deserve this? (Blaming)', score: 3 },
                    { letter: 'D', text: 'Complaining to everyone about your bad luck', score: 3 },
                    { letter: 'E', text: 'Sad but trying to accept', score: 2 },
                    { letter: 'F', text: "Alhamdulillah, trust Allah's wisdom", score: 0 }
                ]
            },
            {
                id: 15,
                category: 'allah',
                type: 'multiple',
                scenario: 'Crisis hits. You need urgent help. Your first instinct is to:',
                options: [
                    { letter: 'A', text: 'Call people for help immediately', score: 4 },
                    { letter: 'B', text: 'Panic and think who can help me', score: 3 },
                    { letter: 'C', text: 'Try to fix it yourself first', score: 3 },
                    { letter: 'D', text: "Ask people then remember Allah", score: 2 },
                    { letter: 'E', text: "Make quick du'a then take action", score: 1 },
                    { letter: 'F', text: 'Turn to Allah first, then use means', score: 0 }
                ]
            },
            // Category 6: Emotional (Q16-18)
            {
                id: 16,
                category: 'emotional',
                type: 'multiple',
                scenario: 'Someone cuts you off in traffic or pushes you in line rudely. You:',
                options: [
                    { letter: 'A', text: 'Explode immediately with anger/curse', score: 4 },
                    { letter: 'B', text: 'Get very angry, confront them aggressively', score: 3 },
                    { letter: 'C', text: 'Angry inside, make hostile gestures', score: 3 },
                    { letter: 'D', text: 'Annoyed, mutter complaints', score: 2 },
                    { letter: 'E', text: 'Frustrated but stay calm outwardly', score: 1 },
                    { letter: 'F', text: 'Remain calm, assume good reason', score: 0 }
                ]
            },
            {
                id: 17,
                category: 'emotional',
                type: 'multiple',
                scenario: 'You wake up Monday morning. First thoughts about the day ahead are:',
                options: [
                    { letter: 'A', text: 'This day will be terrible', score: 4 },
                    { letter: 'B', text: 'Here we go again, same problems', score: 3 },
                    { letter: 'C', text: 'Worried about what might go wrong', score: 3 },
                    { letter: 'D', text: 'Neutral, taking it as it comes', score: 2 },
                    { letter: 'E', text: 'Hopeful but cautious', score: 1 },
                    { letter: 'F', text: 'Grateful for a new day, optimistic', score: 0 }
                ]
            },
            {
                id: 18,
                category: 'emotional',
                type: 'multiple',
                scenario: 'Discussion with someone who disagrees with you. You:',
                options: [
                    { letter: 'A', text: 'Must win at all costs, get aggressive', score: 4 },
                    { letter: 'B', text: "Argue intensely, can't let them be right", score: 3 },
                    { letter: 'C', text: 'Keep pushing your point repeatedly', score: 3 },
                    { letter: 'D', text: 'Debate but willing to stop if needed', score: 2 },
                    { letter: 'E', text: 'Discuss to understand, not to win', score: 1 },
                    { letter: 'F', text: 'Listen genuinely, willing to be wrong', score: 0 }
                ]
            }
        ];

        // PHASE 2 QUESTIONS - ADAPTIVE DEEP DIVE
        const PHASE2_QUESTIONS = {
            wealth: [
                {
                    id: 19,
                    category: 'wealth',
                    type: 'slider',
                    scenario: "You have stable income and savings. A friend mentions economic crisis. You:",
                    statement: "I immediately worry about losing everything and start hoarding/over-saving"
                },
                {
                    id: 20,
                    category: 'wealth',
                    type: 'multiple',
                    scenario: "A family member needs urgent money for medical treatment. You can afford it. You:",
                    options: [
                        { letter: 'A', text: 'Give immediately, whatever they need', score: 0 },
                        { letter: 'B', text: 'Give but calculate how it affects your plans', score: 1 },
                        { letter: 'C', text: 'Give minimum, feel pain doing it', score: 3 },
                        { letter: 'D', text: 'Make excuses, suggest they find other sources', score: 4 },
                        { letter: 'E', text: 'Avoid the situation completely', score: 4 }
                    ]
                },
                {
                    id: 21,
                    category: 'wealth',
                    type: 'multiple',
                    scenario: "You have free time - 2 hours. You can pray, read Quran, OR work on side business. You:",
                    options: [
                        { letter: 'A', text: 'Always choose the money-making option', score: 4 },
                        { letter: 'B', text: 'Usually choose work, feel guilty', score: 3 },
                        { letter: 'C', text: 'Torn between both equally', score: 2 },
                        { letter: 'D', text: 'Usually choose worship, but tempted by work', score: 1 },
                        { letter: 'E', text: 'Easily choose worship over money', score: 0 }
                    ]
                },
                {
                    id: 22,
                    category: 'wealth',
                    type: 'slider',
                    scenario: "You just got a major windfall - inheritance or bonus. Your first instinct is:",
                    statement: "I immediately think about what MORE I can get/buy/invest in - never feel it's enough"
                },
                {
                    id: 23,
                    category: 'wealth',
                    type: 'multiple',
                    scenario: "Walking through an affluent neighborhood or scrolling social media. You see wealth. You:",
                    options: [
                        { letter: 'A', text: 'Intensely wish it was yours, feel deprived', score: 4 },
                        { letter: 'B', text: 'Calculate how to get to that level', score: 4 },
                        { letter: 'C', text: 'Feel envious of their lifestyle', score: 3 },
                        { letter: 'D', text: 'Appreciate it but content with yours', score: 1 },
                        { letter: 'E', text: 'Barely notice, focused on your blessings', score: 0 }
                    ]
                }
            ],
            self: [
                {
                    id: 24,
                    category: 'self',
                    type: 'slider',
                    scenario: "You're in a room with people of lower education/status/wealth. You feel:",
                    statement: "I feel superior to them and struggle to learn from or take advice from them"
                },
                {
                    id: 25,
                    category: 'self',
                    type: 'multiple',
                    scenario: "You do something praiseworthy - get promoted, help someone, achieve goal. You:",
                    options: [
                        { letter: 'A', text: 'Constantly replay how amazing you are', score: 4 },
                        { letter: 'B', text: 'Feel very impressed with yourself', score: 3 },
                        { letter: 'C', text: 'Think "I\'m pretty special" frequently', score: 3 },
                        { letter: 'D', text: 'Brief satisfaction then move on', score: 1 },
                        { letter: 'E', text: 'Immediately attribute it to Allah', score: 0 }
                    ]
                },
                {
                    id: 26,
                    category: 'self',
                    type: 'multiple',
                    scenario: "You're about to give charity. No one is watching vs. people are watching. Your behavior:",
                    options: [
                        { letter: 'A', text: 'Only give when people see', score: 4 },
                        { letter: 'B', text: 'Give MUCH more when people see', score: 4 },
                        { letter: 'C', text: 'Give more when visible', score: 3 },
                        { letter: 'D', text: 'Slightly affected by audience', score: 2 },
                        { letter: 'E', text: 'Exactly the same, private or public', score: 0 }
                    ]
                },
                {
                    id: 27,
                    category: 'self',
                    type: 'slider',
                    scenario: "Your good deeds/accomplishments are unknown to most people. This makes you feel:",
                    statement: "I'm frustrated that people don't know my achievements - I want to be known and recognized"
                },
                {
                    id: 28,
                    category: 'self',
                    type: 'multiple',
                    scenario: "You know the right answer in class/meeting but stay silent because:",
                    options: [
                        { letter: 'A', text: 'Never stay silent, always speak up', score: 0 },
                        { letter: 'B', text: 'Afraid of being judged if wrong', score: 3 },
                        { letter: 'C', text: 'Don\'t want to seem like a know-it-all', score: 2 },
                        { letter: 'D', text: 'Shy but will speak if pressed', score: 1 },
                        { letter: 'E', text: 'Strategic silence, not fear-based', score: 0 }
                    ]
                }
            ],
            relationships: [
                {
                    id: 29,
                    category: 'relationships',
                    type: 'slider',
                    scenario: "Best friend gets exactly what you've been praying for. You:",
                    statement: "I wish Allah had given it to me instead, or I wish they'd lose it"
                },
                {
                    id: 30,
                    category: 'relationships',
                    type: 'multiple',
                    scenario: "Think of someone you dislike intensely. Last time you thought of them, you:",
                    options: [
                        { letter: 'A', text: 'Wished harm on them', score: 4 },
                        { letter: 'B', text: 'Imagined revenge scenarios', score: 4 },
                        { letter: 'C', text: 'Replayed their wrongs with anger', score: 3 },
                        { letter: 'D', text: 'Neutral but cold thoughts', score: 2 },
                        { letter: 'E', text: 'Made du\'a for them (genuinely)', score: 0 }
                    ]
                },
                {
                    id: 31,
                    category: 'relationships',
                    type: 'slider',
                    scenario: "Someone wronged you years ago. Today you remember it. You:",
                    statement: "I replay it vividly, feel the anger again, and plan how to get back at them someday"
                },
                {
                    id: 32,
                    category: 'relationships',
                    type: 'multiple',
                    scenario: "You have power/authority over someone (employee, student, child). When they make mistakes, you:",
                    options: [
                        { letter: 'A', text: 'Use your power to humiliate them', score: 4 },
                        { letter: 'B', text: 'Punish excessively to assert dominance', score: 4 },
                        { letter: 'C', text: 'Strict but fair', score: 1 },
                        { letter: 'D', text: 'Kind but firm', score: 0 },
                        { letter: 'E', text: 'Merciful and forgiving', score: 0 }
                    ]
                },
                {
                    id: 33,
                    category: 'relationships',
                    type: 'multiple',
                    scenario: "Someone does something embarrassing in public. Your reaction is:",
                    options: [
                        { letter: 'A', text: 'Laugh and point it out to others', score: 4 },
                        { letter: 'B', text: 'Mock them to make yourself feel better', score: 4 },
                        { letter: 'C', text: 'Laugh inside but stay quiet', score: 2 },
                        { letter: 'D', text: 'Feel empathy for them', score: 0 },
                        { letter: 'E', text: 'Help them if possible', score: 0 }
                    ]
                }
            ],
            desires: [
                {
                    id: 34,
                    category: 'desires',
                    type: 'slider',
                    scenario: "You're fasting or in i'tikaf. Inappropriate thoughts arise. You:",
                    statement: "I entertain these thoughts and even seek out triggers despite the sacred time"
                },
                {
                    id: 35,
                    category: 'desires',
                    type: 'multiple',
                    scenario: "You know you shouldn't do something (waste time, eat excessively, buy unnecessarily). You:",
                    options: [
                        { letter: 'A', text: 'Do it anyway without hesitation', score: 4 },
                        { letter: 'B', text: 'Do it while making excuses', score: 3 },
                        { letter: 'C', text: 'Internal battle, usually give in', score: 2 },
                        { letter: 'D', text: 'Resist most of the time', score: 1 },
                        { letter: 'E', text: 'Firmly resist and redirect', score: 0 }
                    ]
                },
                {
                    id: 36,
                    category: 'desires',
                    type: 'multiple',
                    scenario: "How much time daily do you spend fantasizing about unrealistic scenarios?",
                    options: [
                        { letter: 'A', text: 'Hours - most of my free time', score: 4 },
                        { letter: 'B', text: 'Frequently throughout the day', score: 3 },
                        { letter: 'C', text: 'Sometimes when bored', score: 2 },
                        { letter: 'D', text: 'Rarely, mostly focused', score: 1 },
                        { letter: 'E', text: 'Almost never, present in reality', score: 0 }
                    ]
                },
                {
                    id: 37,
                    category: 'desires',
                    type: 'slider',
                    scenario: "When is the last time you seriously reflected on death and prepared for it?",
                    statement: "I actively avoid all reminders of death - no funerals, no talks, no thinking about it"
                },
                {
                    id: 38,
                    category: 'desires',
                    type: 'multiple',
                    scenario: "Buffet or unlimited food available. You:",
                    options: [
                        { letter: 'A', text: 'Eat until very full, can\'t resist', score: 4 },
                        { letter: 'B', text: 'Eat more than needed', score: 3 },
                        { letter: 'C', text: 'Eat reasonable amount', score: 2 },
                        { letter: 'D', text: 'Eat moderately, stop before full', score: 1 },
                        { letter: 'E', text: 'Eat little, practice restraint', score: 0 }
                    ]
                }
            ],
            allah: [
                {
                    id: 39,
                    category: 'allah',
                    type: 'slider',
                    scenario: "Entire day passes. You realize you barely thought of Allah. This happens:",
                    statement: "Most days pass where I'm completely heedless of Allah from morning to night"
                },
                {
                    id: 40,
                    category: 'allah',
                    type: 'multiple',
                    scenario: "When major trial hits, your honest thoughts are:",
                    options: [
                        { letter: 'A', text: 'Allah is unfair, I don\'t deserve this', score: 4 },
                        { letter: 'B', text: 'Why me? What did I do wrong?', score: 3 },
                        { letter: 'C', text: 'This is too hard, complain to people', score: 3 },
                        { letter: 'D', text: 'Struggling but trying to be patient', score: 1 },
                        { letter: 'E', text: 'Alhamdulillah \'ala kulli hal', score: 0 }
                    ]
                },
                {
                    id: 41,
                    category: 'allah',
                    type: 'multiple',
                    scenario: "Before making decisions or facing problems, who do you turn to FIRST?",
                    options: [
                        { letter: 'A', text: 'People - parents, spouse, friends', score: 4 },
                        { letter: 'B', text: 'Google/online research', score: 3 },
                        { letter: 'C', text: 'My own abilities and planning', score: 3 },
                        { letter: 'D', text: 'People then Allah', score: 2 },
                        { letter: 'E', text: 'Allah first, then means', score: 0 }
                    ]
                },
                {
                    id: 42,
                    category: 'allah',
                    type: 'slider',
                    scenario: "When counting blessings vs. counting problems, you:",
                    statement: "I focus almost entirely on what's missing/wrong in my life and rarely feel grateful"
                },
                {
                    id: 43,
                    category: 'allah',
                    type: 'multiple',
                    scenario: "You sin regularly but think:",
                    options: [
                        { letter: 'A', text: 'Allah will forgive anyway, no rush to repent', score: 4 },
                        { letter: 'B', text: 'I have time, I\'ll fix it later', score: 3 },
                        { letter: 'C', text: 'I\'m not that bad compared to others', score: 3 },
                        { letter: 'D', text: 'Concerned but still procrastinating', score: 2 },
                        { letter: 'E', text: 'Urgently seeking to repent now', score: 0 }
                    ]
                }
            ],
            emotional: [
                {
                    id: 44,
                    category: 'emotional',
                    type: 'multiple',
                    scenario: "Last time you were very angry, what did you do?",
                    options: [
                        { letter: 'A', text: 'Yelled, said very hurtful things', score: 4 },
                        { letter: 'B', text: 'Physically aggressive (hit/throw things)', score: 4 },
                        { letter: 'C', text: 'Silent but seething for hours/days', score: 3 },
                        { letter: 'D', text: 'Expressed anger but controlled', score: 1 },
                        { letter: 'E', text: 'Changed position, made wudu, calmed down', score: 0 }
                    ]
                },
                {
                    id: 45,
                    category: 'emotional',
                    type: 'slider',
                    scenario: "When something good happens, your thought pattern is:",
                    statement: "I immediately think about what will go wrong or how it won't last"
                },
                {
                    id: 46,
                    category: 'emotional',
                    type: 'multiple',
                    scenario: "In debates, being RIGHT is:",
                    options: [
                        { letter: 'A', text: 'Essential - I can\'t let them win', score: 4 },
                        { letter: 'B', text: 'Very important to me', score: 3 },
                        { letter: 'C', text: 'Important but not crucial', score: 2 },
                        { letter: 'D', text: 'Less important than truth', score: 1 },
                        { letter: 'E', text: 'Unimportant - seeking truth together', score: 0 }
                    ]
                },
                {
                    id: 47,
                    category: 'emotional',
                    type: 'multiple',
                    scenario: "Regarding your spiritual state, you believe:",
                    options: [
                        { letter: 'A', text: 'I\'m very advanced spiritually', score: 4 },
                        { letter: 'B', text: 'I\'m better than most people', score: 3 },
                        { letter: 'C', text: 'I\'m doing pretty well', score: 2 },
                        { letter: 'D', text: 'I have a lot of work to do', score: 0 },
                        { letter: 'E', text: 'I\'m in desperate need of purification', score: 0 }
                    ]
                },
                {
                    id: 48,
                    category: 'emotional',
                    type: 'slider',
                    scenario: "In dealings with others (work, business, relationships), you:",
                    statement: "I present myself as better than I am or hide my faults to get what I want"
                }
            ]
        };

        const CATEGORIES = {
            wealth: { name: 'Wealth & Provision', nameAr: 'ÿßŸÑŸÖŸéÿßŸÑ ŸàŸéÿßŸÑÿ±ŸêŸëÿ≤ŸíŸÇ' },
            self: { name: 'Self & Ego', nameAr: 'ÿßŸÑŸÜŸéŸëŸÅŸíÿ≥' },
            relationships: { name: 'Relationships', nameAr: 'ÿßŸÑŸÜŸéŸëÿßÿ≥' },
            desires: { name: 'Desires & Appetites', nameAr: 'ÿßŸÑÿ¥ŸéŸëŸáŸéŸàŸéÿßÿ™' },
            allah: { name: 'Relationship with Allah', nameAr: 'ÿßŸÑŸÑŸá' },
            emotional: { name: 'Emotional Control', nameAr: 'ÿßŸÑÿ≠ŸéÿßŸÑŸéÿßÿ™ ÿßŸÑŸÜŸéŸëŸÅŸíÿ≥ŸêŸäŸéŸëÿ©' }
        };

        // State
        let currentPhase = 'welcome';
        let phase1Index = 0;
        let phase1Answers = {};
        let phase2Answers = {};
        let flaggedCategories = [];
        let phase2Index = 0;
        let phase2CurrentCategory = 0;
        let phase2Questions = [];

        function startAssessment() {
            document.getElementById('welcome-screen').classList.add('hidden');
            document.getElementById('phase1-screen').classList.remove('hidden');
            currentPhase = 'phase1';
            renderPhase1();
        }

        function renderPhase1() {
            const question = PHASE1_QUESTIONS[phase1Index];
            const questionNumber = phase1Index + 1;
            
            let html = `
                <div class="question">
                    <div class="question-text">
                        <span class="question-number">${questionNumber}</span>
                        <strong>Scenario:</strong>
                    </div>
                    <div class="scenario">${question.scenario}</div>
                    <div class="options" id="options-container">
            `;
            
            question.options.forEach((opt, idx) => {
                const selected = phase1Answers[question.id] === idx ? 'selected' : '';
                html += `
                    <div class="option ${selected}" onclick="selectOption(${idx})">
                        <span class="option-letter">${opt.letter}</span>
                        <span>${opt.text}</span>
                    </div>
                `;
            });
            
            html += `
                    </div>
                </div>
            `;
            
            document.getElementById('questions-phase1').innerHTML = html;
            updateProgressPhase1();
            updateNavigationPhase1();
        }

        function selectOption(index) {
            const question = PHASE1_QUESTIONS[phase1Index];
            phase1Answers[question.id] = index;
            renderPhase1();
            document.getElementById('next-btn-phase1').disabled = false;
        }

        function updateProgressPhase1() {
            const progress = ((phase1Index + 1) / 18) * 100;
            document.getElementById('progress-bar-phase1').style.width = progress + '%';
            document.getElementById('progress-text-phase1').textContent = `Question ${phase1Index + 1} of 18`;
        }

        function updateNavigationPhase1() {
            document.getElementById('back-btn-phase1').style.display = phase1Index > 0 ? 'inline-block' : 'none';
            document.getElementById('next-btn-phase1').disabled = phase1Answers[PHASE1_QUESTIONS[phase1Index].id] === undefined;
        }

        function nextPhase1() {
            if (phase1Index < 17) {
                phase1Index++;
                renderPhase1();
            } else {
                analyzePhase1();
            }
        }

        function goBackPhase1() {
            if (phase1Index > 0) {
                phase1Index--;
                renderPhase1();
            }
        }

        function analyzePhase1() {
            // Calculate category scores
            const categoryScores = {};
            
            PHASE1_QUESTIONS.forEach(q => {
                if (!categoryScores[q.category]) categoryScores[q.category] = 0;
                const answerIndex = phase1Answers[q.id];
                if (answerIndex !== undefined) {
                    categoryScores[q.category] += q.options[answerIndex].score;
                }
            });
            
            // Flag categories with score >= 6
            flaggedCategories = [];
            for (let cat in categoryScores) {
                if (categoryScores[cat] >= 6) {
                    flaggedCategories.push(cat);
                }
            }
            
            if (flaggedCategories.length === 0) {
                showResults();
            } else {
                showTransition();
            }
        }

        function showTransition() {
            document.getElementById('phase1-screen').classList.add('hidden');
            document.getElementById('transition-screen').classList.remove('hidden');
            
            let html = '';
            flaggedCategories.forEach(cat => {
                html += `<div class="flagged-category-badge">${CATEGORIES[cat].name}</div>`;
            });
            document.getElementById('flagged-list').innerHTML = html;
        }

        function startPhase2() {
            // Build Phase 2 question queue from flagged categories
            phase2Questions = [];
            flaggedCategories.forEach(cat => {
                PHASE2_QUESTIONS[cat].forEach(q => {
                    phase2Questions.push(q);
                });
            });
            
            phase2Index = 0;
            phase2Answers = {};
            
            document.getElementById('transition-screen').classList.add('hidden');
            document.getElementById('phase2-screen').classList.remove('hidden');
            currentPhase = 'phase2';
            renderPhase2();
        }

        function renderPhase2() {
            const question = phase2Questions[phase2Index];
            const questionNumber = 19 + phase2Index; // Continue numbering from Phase 1
            
            let html = `
                <div class="question">
                    <div class="question-text">
                        <span class="question-number">${questionNumber}</span>
                        <strong>Scenario:</strong>
                    </div>
                    <div class="scenario">${question.scenario}</div>
            `;
            
            if (question.type === 'multiple') {
                html += `<div class="options">`;
                question.options.forEach((opt, idx) => {
                    const selected = phase2Answers[question.id] === idx ? 'selected' : '';
                    html += `
                        <div class="option ${selected}" onclick="selectOptionPhase2(${idx})">
                            <span class="option-letter">${opt.letter}</span>
                            <span>${opt.text}</span>
                        </div>
                    `;
                });
                html += `</div>`;
            } else if (question.type === 'slider') {
                const value = phase2Answers[question.id] !== undefined ? phase2Answers[question.id] : 2;
                html += `
                    <div class="slider-container">
                        <div style="font-weight: 600; margin-bottom: 15px;">${question.statement}</div>
                        <div class="slider-labels">
                            <span>Never (0)</span>
                            <span>Sometimes (2)</span>
                            <span>Always (4)</span>
                        </div>
                        <input type="range" min="0" max="4" value="${value}" 
                               oninput="updateSlider(this.value, ${question.id})" 
                               onchange="selectSliderPhase2(this.value)">
                        <div class="slider-value" id="slider-value-${question.id}">${value}</div>
                    </div>
                `;
            }
            
            html += `</div>`;
            
            document.getElementById('questions-container-2').innerHTML = html;
            updateProgressPhase2();
            updateNavigationPhase2();
        }

        function selectOptionPhase2(index) {
            const question = phase2Questions[phase2Index];
            phase2Answers[question.id] = index;
            renderPhase2();
            document.getElementById('next-btn-2').disabled = false;
        }

        function updateSlider(value, questionId) {
            document.getElementById(`slider-value-${questionId}`).textContent = value;
        }

        function selectSliderPhase2(value) {
            const question = phase2Questions[phase2Index];
            phase2Answers[question.id] = parseInt(value);
            document.getElementById('next-btn-2').disabled = false;
        }

        function updateProgressPhase2() {
            const progress = ((phase2Index + 1) / phase2Questions.length) * 100;
            document.getElementById('progress-bar-2').style.width = progress + '%';
            document.getElementById('progress-text-2').textContent = 
                `Question ${19 + phase2Index} of ${18 + phase2Questions.length}`;
        }

        function updateNavigationPhase2() {
            document.getElementById('next-btn-2').disabled = 
                phase2Answers[phase2Questions[phase2Index].id] === undefined;
        }

        function nextQuestionPhase2() {
            if (phase2Index < phase2Questions.length - 1) {
                phase2Index++;
                renderPhase2();
            } else {
                completeAssessment();
            }
        }

        function goBackPhase2() {
            if (phase2Index > 0) {
                phase2Index--;
                renderPhase2();
            }
        }

        function completeAssessment() {
            calculateAndShowResults();
        }

        function calculateAndShowResults() {
            document.getElementById('phase1-screen').classList.add('hidden');
            document.getElementById('phase2-screen').classList.add('hidden');
            document.getElementById('results-screen').classList.remove('hidden');

            // Calculate comprehensive scores
            const categoryScores = {};
            
            // Phase 1 scores
            PHASE1_QUESTIONS.forEach(q => {
                if (!categoryScores[q.category]) {
                    categoryScores[q.category] = { phase1: 0, phase2: 0, totalPoints: 0, maxPoints: 0 };
                }
                const answerIndex = phase1Answers[q.id];
                if (answerIndex !== undefined) {
                    const score = q.options[answerIndex].score;
                    categoryScores[q.category].phase1 += score;
                    categoryScores[q.category].totalPoints += score;
                    categoryScores[q.category].maxPoints += 4;
                }
            });
            
            // Phase 2 scores  
            phase2Questions.forEach(q => {
                if (!categoryScores[q.category]) {
                    categoryScores[q.category] = { phase1: 0, phase2: 0, totalPoints: 0, maxPoints: 0 };
                }
                const answer = phase2Answers[q.id];
                if (answer !== undefined) {
                    let score;
                    if (q.type === 'slider') {
                        score = answer;
                    } else {
                        score = q.options[answer].score;
                    }
                    categoryScores[q.category].phase2 += score;
                    categoryScores[q.category].totalPoints += score;
                    categoryScores[q.category].maxPoints += 4;
                }
            });

            // Calculate percentages and overall health
            let totalPercentage = 0;
            let categoryCount = 0;
            
            for (let cat in categoryScores) {
                const percentage = (categoryScores[cat].totalPoints / categoryScores[cat].maxPoints) * 100;
                categoryScores[cat].diseasePercentage = percentage;
                categoryScores[cat].healthPercentage = 100 - percentage;
                totalPercentage += categoryScores[cat].healthPercentage;
                categoryCount++;
            }
            
            const overallHealth = totalPercentage / categoryCount;
            
            // Display overall score
            document.getElementById('overall-score').textContent = Math.round(overallHealth) + '%';
            
            let healthDesc = '';
            let emoji = '';
            if (overallHealth >= 75) {
                healthDesc = 'Excellent - Your heart is in a sound state (ŸÇŸéŸÑŸíÿ® ÿ≥ŸéŸÑŸêŸäŸÖ)';
                emoji = 'üíö';
            } else if (overallHealth >= 50) {
                healthDesc = 'Good - Your heart is generally healthy but needs attention in some areas';
                emoji = 'üíõ';
            } else if (overallHealth >= 25) {
                healthDesc = 'Concerning - Your heart needs immediate care and treatment';
                emoji = 'üß°';
            } else {
                healthDesc = 'Critical - Your heart is in urgent need of purification';
                emoji = '‚ù§Ô∏è';
            }
            
            document.querySelector('.heart-icon').textContent = emoji;
            document.getElementById('health-description').textContent = healthDesc;

            // Display category breakdown
            let categoriesHTML = '';
            for (let cat in categoryScores) {
                const healthPercent = categoryScores[cat].healthPercentage;
                const catData = CATEGORIES[cat];
                
                let status = '';
                let statusClass = '';
                if (healthPercent >= 75) {
                    status = 'Excellent';
                    statusClass = 'status-excellent';
                } else if (healthPercent >= 50) {
                    status = 'Good';
                    statusClass = 'status-good';
                } else if (healthPercent >= 25) {
                    status = 'Concerning';
                    statusClass = 'status-concerning';
                } else {
                    status = 'Critical';
                    statusClass = 'status-critical';
                }

                categoriesHTML += `
                    <div class="category-card">
                        <div class="category-name">${catData.name}</div>
                        <div style="color: var(--gold); font-size: 0.95rem; margin-bottom: 10px;">${catData.nameAr}</div>
                        <div class="category-score" style="color: ${healthPercent >= 50 ? 'var(--success)' : healthPercent >= 25 ? 'var(--warning)' : 'var(--danger)'}">
                            ${Math.round(healthPercent)}%
                        </div>
                        <div class="category-status ${statusClass}">${status}</div>
                    </div>
                `;
            }
            document.getElementById('categories-results').innerHTML = categoriesHTML;

            // Generate prescriptions for top 3 worst categories
            const sortedCategories = Object.keys(categoryScores).sort((a, b) => 
                categoryScores[b].diseasePercentage - categoryScores[a].diseasePercentage
            );
            
            const top3 = sortedCategories.slice(0, 3).filter(cat => categoryScores[cat].diseasePercentage > 20);
            
            let prescriptionsHTML = '';
            if (top3.length > 0) {
                top3.forEach(cat => {
                    const prescription = generatePrescription(cat, categoryScores[cat]);
                    if (prescription) {
                        prescriptionsHTML += prescription;
                    }
                });
            } else {
                prescriptionsHTML = `
                    <p style="text-align: center; color: var(--success); font-size: 1.2rem; padding: 40px;">
                        ŸÖÿß ÿ¥ÿßÿ° ÿßŸÑŸÑŸá! Your spiritual heart is in excellent condition! üíö<br><br>
                        Continue your beautiful spiritual practices and may Allah preserve your heart's purity.
                    </p>
                `;
            }
            
            document.getElementById('prescriptions-container').innerHTML = prescriptionsHTML;
        }

        function generatePrescription(category, scores) {
            const prescriptions = {
                wealth: {
                    icon: 'üí∞',
                    title: 'Attachment to Wealth',
                    arabic: 'ÿ≠Ÿèÿ®Ÿë ÿßŸÑŸÖŸéÿßŸÑ',
                    understanding: 'The love of wealth can make the heart heedless of Allah and neglectful of the Hereafter. The Prophet Ô∑∫ warned: "Two hungry wolves sent against a flock of sheep are not more destructive than a person\'s greed for wealth and status is to their religion."',
                    immediate: '1. Give sadaqah this week - even if small, break the attachment. 2. Identify one unnecessary expense and redirect that money to charity. 3. Thank Allah for 10 specific blessings related to provision daily.',
                    ongoing: '1. Practice weekly sadaqah - make it a regular habit, even $5. 2. Before any purchase, ask: "Do I need this or just want it?" Wait 24 hours. 3. Monthly: Calculate your wealth, then give more than you\'re comfortable with. 4. Read Surah Al-Takathur daily and reflect on its warning.',
                    spiritual: 'Recite after Fajr: "Allahumma inni a\'udhu bika min al-hammi wal-hazani, wa a\'udhu bika min al-\'ajzi wal-kasali, wa a\'udhu bika min al-jubni wal-bukhli" (O Allah, I seek refuge in You from worry and grief, from helplessness and laziness, from cowardice and miserliness)',
                    reminder: 'Remember: Your rizq is already written. No amount of wealth will go with you to the grave. The only thing that remains is what you spent for Allah\'s sake. Make your wealth work for your Akhirah, not against it.'
                },
                self: {
                    icon: 'üë§',
                    title: 'Diseases of the Ego',
                    arabic: 'ÿ£ŸéŸÖŸíÿ±Ÿéÿßÿ∂ ÿßŸÑŸÜŸéŸëŸÅŸíÿ≥',
                    understanding: 'Arrogance, vanity, and seeking praise are among the most destructive diseases. They block entry to Jannah. The Prophet Ô∑∫ said: "No one with an atom\'s weight of arrogance will enter Paradise." These diseases blind us to our faults and make us see ourselves as better than others.',
                    immediate: '1. This week, sincerely ask forgiveness from someone you wronged. 2. Do a good deed in complete secret - tell no one. 3. Serve someone you consider "below" you with genuine humility. 4. Write down 10 of your worst faults and keep them visible.',
                    ongoing: '1. Daily: Reflect on your death and decay - you will return to dust. 2. Seek feedback from trusted people about your character flaws. 3. Serve others weekly without seeking recognition. 4. When praised, immediately say "Alhamdulillah" and attribute success to Allah. 5. Regularly visit graves to remember your end.',
                    spiritual: 'After every Salah, make sincere dua: "Allahumma inni a\'udhu bika min al-kibri wal-\'ujbi war-riya\' was-sum\'ah" (O Allah, I seek refuge in You from arrogance, vanity, ostentation, and seeking reputation). Recite: "Subhana Rabbiya al-A\'la" (Glory be to my Lord, the Most High) 100x daily - affirming Allah\'s highness and your lowliness.',
                    reminder: 'You are nothing but a slave of Allah. Every good in you is from Him, every fault is from your own soul. The greatest people were the most humble. Iblis was destroyed by arrogance - don\'t follow his path. True honor comes only from taqwa, not status or achievements.'
                },
                relationships: {
                    icon: 'üòî',
                    title: 'Envy & Hatred',
                    arabic: 'ÿ≠Ÿéÿ≥ŸéÿØ ŸàŸéÿ®Ÿèÿ∫Ÿíÿ∂',
                    understanding: 'Envy is wishing for the removal of Allah\'s blessing from another. It\'s a poison that consumes good deeds like fire consumes wood. Hatred and rancor keep the heart chained to past hurts, preventing spiritual progress. These diseases disconnect you from Allah\'s mercy.',
                    immediate: '1. When you feel envy, immediately make sincere dua FOR that person. 2. This week, give a gift to someone you envy. 3. List 10 blessings unique to you that others don\'t have. 4. Forgive one person who wronged you - let it go completely.',
                    ongoing: '1. Daily dhikr: "Alhamdulillah \'ala kulli hal" 100x after Fajr (Praise Allah in all circumstances). 2. Practice making dua for people when you hear of their success. 3. Journal 5 specific blessings daily - train your heart to see YOUR gifts. 4. Give sadaqah when envious thoughts arise. 5. Actively congratulate and celebrate others\' success.',
                    spiritual: 'Recite Surah Al-Falaq daily after every Salah: "Say: I seek refuge in the Lord of Daybreak... from the evil of the envier when he envies." Make this dua: "Allahumma inni a\'udhu bika min sharri nafsi" (O Allah, I seek refuge in You from the evil of my own soul). Forgive those who wronged you, for your own heart\'s sake.',
                    reminder: 'The one who envies is rejecting Allah\'s wisdom in His distribution. Trust that Allah knows what\'s best for you. Your rizq is written - no one can take it. The cure for envy is contentment (qana\'ah), and contentment is the greatest treasure. As for those you dislike: their account is with Allah, not you. Free your heart by forgiving.'
                },
                desires: {
                    icon: 'üî•',
                    title: 'Following Desires',
                    arabic: 'ÿßŸêÿ™ŸêŸëÿ®Ÿéÿßÿπ ÿßŸÑŸáŸéŸàŸéŸâ',
                    understanding: 'Following desires (hawa) makes the self your god. Allah says: "Have you seen the one who takes his desire as his god?" Unchecked desires lead to spiritual blindness. They promise pleasure but deliver emptiness and regret. The heart enslaved to desires can never taste true freedom or peace.',
                    immediate: '1. Fast Monday and Thursday this month. 2. Identify your biggest temptation and avoid its triggers this week. 3. When desire arises, make wudu immediately and pray 2 rakah. 4. Delete/block one source of temptation from your phone/computer.',
                    ongoing: '1. Regular fasting (Mondays, Thursdays, white days) - the Prophet\'s prescription for controlling desires. 2. Lower your gaze consistently - train your eyes and heart. 3. Pray Tahajjud (even 2 rakah) - wake before Fajr to break the pattern of following nafs. 4. Marry if able, or fast frequently if not. 5. Never be alone with your phone in a weak moment - environmental discipline.',
                    spiritual: 'Recite before sleep and when tempted: "A\'udhu bi-kalimat-illahi at-tammati min ghadabihi wa \'iqabihi wa sharri \'ibadihi wa min hamazat ash-shayatin wa an yahdurun" (I seek refuge in the perfect words of Allah from His anger, punishment, the evil of His servants, the whisperings of devils, and their presence). Increase in: "La hawla wa la quwwata illa billah" (There is no power nor strength except with Allah).',
                    reminder: 'Your nafs (lower self) is your greatest enemy. It will never be satisfied until you discipline it. Every time you resist a desire for Allah\'s sake, you strengthen your soul and weaken shaytaan. The pleasure of obeying Allah far exceeds any forbidden pleasure. Remember death and the questioning - will this sin be worth it then?'
                },
                allah: {
                    icon: '‚ò™Ô∏è',
                    title: 'Heedlessness of Allah',
                    arabic: 'ÿ∫ŸéŸÅŸíŸÑŸéÿ© ÿπŸéŸÜ ÿßŸÑŸÑŸá',
                    understanding: 'Ghaflah (heedlessness) is the root of all spiritual diseases. It means going through life forgetting Allah - the One who gave you everything. The heart becomes so busy with dunya that it forgets its true purpose: knowing, loving, and worshipping Allah. This is the most dangerous state because all other sins become easy.',
                    immediate: '1. Set 5 prayer time reminders - stop what you\'re doing and pray on time this week. 2. After each Salah, sit for 2 minutes of silent dhikr (nothing else). 3. Before sleep, review your day and ask: "How much did I remember Allah today?" 4. Put a sticky note where you work: "Remember Allah".',
                    ongoing: '1. Morning and evening adhkar DAILY without fail - this protects your heart. 2. Pray all 5 Salah with khushu\' - fight distraction. If your mind wanders, restart the Surah. 3. Weekly: Attend Jumu\'ah early, listen to khutbah, make dua. 4. Learn one Name of Allah each week and reflect on it throughout the day. 5. Read Quran daily with translation - even 1 page. Let Allah speak to your heart.',
                    spiritual: 'Increase in: "SubhanAllah wa bihamdihi, SubhanAllah al-\'Adheem" 100x daily. After Fajr and Maghrib, complete your adhkar fully. Make this dua frequently: "Allahumma a\'inni \'ala dhikrika wa shukrika wa husni \'ibadatik" (O Allah, help me remember You, thank You, and worship You beautifully). Revive Tahajjud - even 2 rakah before Fajr connects you to Allah in His sacred time.',
                    reminder: 'You will die. This life is temporary. Every moment of heedlessness is a moment wasted. But Allah is Most Merciful - He accepts those who return. Start now. Even if you\'ve been heedless for years, turn to Him NOW. He is waiting. Make your heart\'s constant state one of remembrance. Let Allah be your first thought in the morning and last thought at night. This is true life.'
                },
                emotional: {
                    icon: 'üò§',
                    title: 'Anger & Negative Thoughts',
                    arabic: 'ÿ∫Ÿéÿ∂Ÿéÿ® ŸàŸéÿ≥ŸèŸàÿ° ÿßŸÑÿ∏ŸéŸëŸÜŸë',
                    understanding: 'Uncontrolled anger destroys relationships, causes regret, and distances you from Allah\'s mercy. The Prophet Ô∑∫ said: "The strong person is not the one who can wrestle, but the one who controls himself in anger." Negative thoughts (su\' al-dhann) poison your perception and lead to suspicion, anxiety, and injustice toward others.',
                    immediate: '1. When anger arises this week, immediately change position (sit if standing, lie if sitting). 2. Make wudu when angry - water cools the fire. 3. Stay silent when angry - speak only after calming. 4. Practice assuming the BEST about others\' intentions this week.',
                    ongoing: '1. Fast regularly - it cools temperament and teaches self-control. 2. When negative thoughts about someone arise, replace them with 3 good assumptions. 3. Avoid argumentative people and topics that trigger you. 4. Daily: Reflect on how Allah forgives YOUR mistakes, so forgive others. 5. Seek anger management if needed - it\'s part of purification.',
                    spiritual: 'When angry, seek refuge: "A\'udhu billahi min ash-shaytaan ir-rajeem" (I seek refuge in Allah from the cursed devil). The Prophet Ô∑∫ taught: Anger is from shaytaan. Repeat: "La hawla wa la quwwata illa billah" (There is no power except with Allah). Make istighfar (seek forgiveness) 100x daily - it softens the heart. Before judging anyone, remember: Allah knows, you don\'t.',
                    reminder: 'Every moment of anger damages your heart and relationships. Every negative thought is often wrong. Most people are doing their best. You see only actions, Allah sees intentions. The one who controls anger earns Allah\'s love. Train yourself: respond, don\'t react. Pause. Breathe. Remember Allah. Then act. This is strength. This is wisdom.'
                }
            };
            
            const p = prescriptions[category];
            if (!p) return '';
            
            return `
                <div class="prescription">
                    <div class="prescription-header">
                        <div class="prescription-icon">${p.icon}</div>
                        <div>
                            <div class="prescription-title">${p.title}</div>
                            <div class="prescription-arabic">${p.arabic}</div>
                        </div>
                    </div>
                    <div class="prescription-section">
                        <div class="prescription-section-title">üí° Understanding</div>
                        <div class="prescription-content">${p.understanding}</div>
                    </div>
                    <div class="prescription-section">
                        <div class="prescription-section-title">üî• Immediate Action (This Week)</div>
                        <div class="prescription-content">${p.immediate}</div>
                    </div>
                    <div class="prescription-section">
                        <div class="prescription-section-title">üå± Ongoing Practice (40 Days)</div>
                        <div class="prescription-content">${p.ongoing}</div>
                    </div>
                    <div class="prescription-section">
                        <div class="prescription-section-title">üìø Spiritual Remedy</div>
                        <div class="prescription-content">${p.spiritual}</div>
                    </div>
                    <div class="power-reminder">
                        <strong>‚ö° Power Reminder:</strong> ${p.reminder}
                    </div>
                </div>
            `;
        }

        function retakeAssessment() {
            phase1Index = 0;
            phase1Answers = {};
            phase2Answers = {};
            phase2Questions = [];
            phase2Index = 0;
            flaggedCategories = [];
            
            document.getElementById('results-screen').classList.add('hidden');
            document.getElementById('welcome-screen').classList.remove('hidden');
        }

        function saveResults() {
            const timestamp = new Date().toISOString();
            const results = {
                timestamp,
                phase1Answers,
                phase2Answers
            };
            
            const hash = btoa(timestamp).substring(0, 10);
            localStorage.setItem(`qalb_${hash}`, JSON.stringify(results));
            
            alert(`Results saved! Your unique code is: ${hash}\n\nYou can retake this assessment anytime to track your progress.`);
        }

        // ========================================
        // PWA SERVICE WORKER REGISTRATION
        // ========================================
        
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then(registration => {
                        console.log('‚úÖ Service Worker registered!', registration.scope);
                    })
                    .catch(error => {
                        console.log('‚ùå Service Worker registration failed:', error);
                    });
            });
        }

        // ========================================
        // PWA INSTALL PROMPT
        // ========================================
        
        let deferredInstallPrompt = null;

        window.addEventListener('beforeinstallprompt', (e) => {
            console.log('üíæ Install prompt ready');
            e.preventDefault();
            deferredInstallPrompt = e;
            
            // Show custom install banner
            document.getElementById('install-banner').style.display = 'block';
        });

        function installPWA() {
            if (deferredInstallPrompt) {
                deferredInstallPrompt.prompt();
                
                deferredInstallPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('‚úÖ User accepted the install');
                    } else {
                        console.log('‚ùå User dismissed the install');
                    }
                    deferredInstallPrompt = null;
                    dismissInstallBanner();
                });
            }
        }

        function dismissInstallBanner() {
            document.getElementById('install-banner').style.display = 'none';
        }

        // Check if app is installed
        window.addEventListener('appinstalled', (e) => {
            console.log('üéâ PWA was installed successfully!');
            dismissInstallBanner();
        });

        // ============================================
        // URDU LANGUAGE TOGGLE - SIMPLE & WORKING
        // ============================================
        
        // Store original English scenarios
        const ENGLISH_SCENARIOS = [
            'You receive your salary and see an urgent appeal for people suffering in Gaza. What do you normally do?',
            'You\'re at a restaurant with friends. The bill comes and it\'s more than expected. Your first thought:',
            'A colleague shows you their new car/phone/house. Your immediate reaction:',
            'Someone publicly points out your mistake. Your immediate reaction:',
            'You significantly help someone but nobody knows. How do you feel?',
            'A security guard/cleaner/waiter treats you poorly without reason. You:',
            'Your friend excitedly calls - they got a job paying 4x your salary. Your immediate feeling:',
            'Someone spreads lies about you or harms you. Months later you think of them. You:',
            'Someone apologizes to you but you know it\'s not sincere. You:',
            'You\'re alone with your phone/computer. Temptation to view something inappropriate. You:',
            'It\'s Fajr time. Your alarm goes off. Bed is warm and cozy. You:',
            'Someone mentions death or you see a funeral. Your immediate reaction:',
            'You\'re in the middle of prayer. Your mind:',
            'You face a major setback - job loss, illness, or rejection. Your first thought:',
            'A crisis hits. You need urgent help. Your first instinct:',
            'Someone cuts you off in traffic or rudely pushes in line. You:',
            'You wake up Monday morning. First thoughts about the day ahead are:',
            'Discussion with someone who disagrees with you. You:'
        ];
        
        // Urdu translations
        const URDU_SCENARIOS = [
            'ÿ¢Ÿæ ⁄©Ÿà ÿ™ŸÜÿÆŸàÿß€Å ŸÖŸÑÿ™€å €Å€í ÿßŸàÿ± ÿ¢Ÿæ ÿ∫ÿ≤€Å ŸÖ€å⁄∫ ŸÖÿµ€åÿ®ÿ™ ÿ≤ÿØ€Å ŸÑŸà⁄ØŸà⁄∫ ⁄©€í ŸÑ€å€í ŸÅŸàÿ±€å ÿßŸæ€åŸÑ ÿØ€å⁄©⁄æÿ™€í €Å€å⁄∫€î ÿ¢Ÿæ ÿπÿßŸÖ ÿ∑Ÿàÿ± Ÿæÿ± ⁄©€åÿß ⁄©ÿ±ÿ™€í €Å€å⁄∫ÿü',
            'ÿ¢Ÿæ ÿØŸàÿ≥ÿ™Ÿà⁄∫ ⁄©€í ÿ≥ÿßÿ™⁄æ ÿ±€åÿ≥ÿ™Ÿàÿ±ÿß⁄∫ ŸÖ€å⁄∫ €Å€å⁄∫€î ÿ®ŸÑ ÿ¢ÿ™ÿß €Å€í ÿßŸàÿ± €å€Å ÿ™ŸàŸÇÿπ ÿ≥€í ÿ≤€åÿßÿØ€Å €Å€í€î ÿ¢Ÿæ ⁄©ÿß Ÿæ€ÅŸÑÿß ÿÆ€åÿßŸÑ:',
            'ÿß€å⁄© ÿ≥ÿßÿ™⁄æ€å ÿ¢Ÿæ ⁄©Ÿà ÿßŸæŸÜ€å ŸÜÿ¶€å ⁄Øÿß⁄ë€å/ŸÅŸàŸÜ/⁄Ø⁄æÿ± ÿØ⁄©⁄æÿßÿ™ÿß €Å€í€î ÿ¢Ÿæ ⁄©ÿß ŸÅŸàÿ±€å ÿ±ÿØÿπŸÖŸÑ:',
            '⁄©Ÿàÿ¶€å ÿπŸàÿßŸÖ€å ÿ∑Ÿàÿ± Ÿæÿ± ÿ¢Ÿæ ⁄©€å ÿ∫ŸÑÿ∑€å ⁄©€å ŸÜÿ¥ÿßŸÜÿØ€Å€å ⁄©ÿ±ÿ™ÿß €Å€í€î ÿ¢Ÿæ ⁄©ÿß ŸÅŸàÿ±€å ÿ±ÿØÿπŸÖŸÑ:',
            'ÿ¢Ÿæ ⁄©ÿ≥€å ⁄©€å ŸÜŸÖÿß€åÿß⁄∫ ŸÖÿØÿØ ⁄©ÿ±ÿ™€í €Å€å⁄∫ ŸÑ€å⁄©ŸÜ ⁄©Ÿàÿ¶€å ŸÜ€Å€å⁄∫ ÿ¨ÿßŸÜÿ™ÿß€î ÿ¢Ÿæ ⁄©€åÿ≥ÿß ŸÖÿ≠ÿ≥Ÿàÿ≥ ⁄©ÿ±ÿ™€í €Å€å⁄∫ÿü',
            'ÿß€å⁄© ÿ≥€å⁄©€åŸàÿ±Ÿπ€å ⁄Øÿßÿ±⁄à/ÿµŸÅÿßÿ¶€å ⁄©ÿ±ŸÜ€í ŸàÿßŸÑÿß/ÿÆÿØŸÖÿ™ ⁄Øÿßÿ± ÿ®ŸÑÿß Ÿàÿ¨€Å ÿ¢Ÿæ ÿ≥€í ÿ®ÿ±ÿß ÿ≥ŸÑŸà⁄© ⁄©ÿ±ÿ™ÿß €Å€í€î ÿ¢Ÿæ ⁄©€åÿß ⁄©ÿ±ÿ™€í €Å€å⁄∫ÿü',
            'ÿ¢Ÿæ ⁄©ÿß ÿØŸàÿ≥ÿ™ Ÿæÿ±ÿ¨Ÿàÿ¥ €ÅŸà ⁄©ÿ± ŸÅŸàŸÜ ⁄©ÿ±ÿ™ÿß €Å€í - ÿßŸÜ€Å€å⁄∫ ÿ¢Ÿæ ⁄©€å ÿ™ŸÜÿÆŸàÿß€Å ÿ≥€í 4 ⁄ØŸÜÿß ŸÖŸÑÿßÿ≤ŸÖÿ™ ŸÖŸÑ ⁄Øÿ¶€å€î ÿ¢Ÿæ ⁄©ÿß ŸÅŸàÿ±€å ÿßÿ≠ÿ≥ÿßÿ≥:',
            '⁄©Ÿàÿ¶€å ÿ¢Ÿæ ⁄©€í ÿ®ÿßÿ±€í ŸÖ€å⁄∫ ÿ¨⁄æŸàŸπ Ÿæ⁄æ€åŸÑÿßÿ™ÿß €Å€í €åÿß ÿ¢Ÿæ ⁄©Ÿà ŸÜŸÇÿµÿßŸÜ Ÿæ€ÅŸÜ⁄Üÿßÿ™ÿß €Å€í€î ŸÖ€Å€åŸÜŸà⁄∫ ÿ®ÿπÿØ ÿ¢Ÿæ ÿßŸÜ ⁄©€í ÿ®ÿßÿ±€í ŸÖ€å⁄∫ ÿ≥Ÿà⁄Üÿ™€í €Å€å⁄∫€î ÿ¢Ÿæ:',
            '⁄©Ÿàÿ¶€å ÿ¢Ÿæ ÿ≥€í ŸÖÿπÿ∞ÿ±ÿ™ ŸÖÿßŸÜ⁄Øÿ™ÿß €Å€í ŸÑ€å⁄©ŸÜ ÿ¢Ÿæ ÿ¨ÿßŸÜÿ™€í €Å€å⁄∫ ⁄©€Å €å€Å ŸÖÿÆŸÑÿµ ŸÜ€Å€å⁄∫ €Å€í€î ÿ¢Ÿæ:',
            'ÿ¢Ÿæ ÿßŸæŸÜ€í ŸÅŸàŸÜ/⁄©ŸÖŸæ€åŸàŸπÿ± ⁄©€í ÿ≥ÿßÿ™⁄æ ÿ™ŸÜ€Åÿß €Å€å⁄∫€î ⁄©⁄Ü⁄æ ŸÜÿßŸÖŸÜÿßÿ≥ÿ® ÿØ€å⁄©⁄æŸÜ€í ⁄©€å ÿ¢ÿ≤ŸÖÿßÿ¶ÿ¥ ÿ¢ÿ™€å €Å€í€î ÿ¢Ÿæ:',
            'ŸÅÿ¨ÿ± ⁄©ÿß ŸàŸÇÿ™ €Å€í€î ÿ¢Ÿæ ⁄©ÿß ÿßŸÑÿßÿ±ŸÖ ÿ®ÿ¨ÿ™ÿß €Å€í€î ÿ®ÿ≥ÿ™ÿ± ⁄Øÿ±ŸÖ ÿßŸàÿ± ÿ¢ÿ±ÿßŸÖ ÿØ€Å €Å€í€î ÿ¢Ÿæ:',
            '⁄©Ÿàÿ¶€å ŸÖŸàÿ™ ⁄©ÿß ÿ∞⁄©ÿ± ⁄©ÿ±ÿ™ÿß €Å€í €åÿß ÿ¢Ÿæ ÿ¨ŸÜÿßÿ≤€Å ÿØ€å⁄©⁄æÿ™€í €Å€å⁄∫€î ÿ¢Ÿæ ⁄©ÿß ŸÅŸàÿ±€å ÿ±ÿØÿπŸÖŸÑ:',
            'ÿ¢Ÿæ ŸÜŸÖÿßÿ≤ ⁄©€í ÿØÿ±ŸÖ€åÿßŸÜ €Å€å⁄∫€î ÿ¢Ÿæ ⁄©ÿß ÿ∞€ÅŸÜ:',
            'ÿ¢Ÿæ ⁄©Ÿà ÿ®⁄ëÿß ÿØ⁄æ⁄Ü⁄©ÿß ŸÑ⁄Øÿ™ÿß €Å€í - ŸÖŸÑÿßÿ≤ŸÖÿ™ ⁄Ü⁄æŸàŸπŸÜÿßÿå ÿ®€åŸÖÿßÿ±€åÿå €åÿß ŸÖÿ≥ÿ™ÿ±ÿØ €ÅŸàŸÜÿß€î ÿ¢Ÿæ ⁄©ÿß Ÿæ€ÅŸÑÿß ÿÆ€åÿßŸÑ:',
            'ÿ®ÿ≠ÿ±ÿßŸÜ ÿ¢ÿ™ÿß €Å€í€î ÿ¢Ÿæ ⁄©Ÿà ŸÅŸàÿ±€å ŸÖÿØÿØ ⁄Üÿß€Å€å€í€î ÿ¢Ÿæ ⁄©€å Ÿæ€ÅŸÑ€å ŸÅÿ∑ÿ±€å ÿ±ÿØ ÿπŸÖŸÑ:',
            '⁄©Ÿàÿ¶€å Ÿπÿ±€åŸÅ⁄© ŸÖ€å⁄∫ ÿ¢Ÿæ ⁄©Ÿà ⁄©ÿßŸπÿ™ÿß €Å€í €åÿß ŸÑÿßÿ¶ŸÜ ŸÖ€å⁄∫ ÿ®ÿØÿ™ŸÖ€åÿ≤€å ÿ≥€í ÿØ⁄æ⁄©ÿß ÿØ€åÿ™ÿß €Å€í€î ÿ¢Ÿæ:',
            'ÿ¢Ÿæ Ÿæ€åÿ± ⁄©€å ÿµÿ®ÿ≠ ÿ¨ÿß⁄Øÿ™€í €Å€å⁄∫€î ÿ¢ŸÜ€í ŸàÿßŸÑ€í ÿØŸÜ ⁄©€í ÿ®ÿßÿ±€í ŸÖ€å⁄∫ Ÿæ€ÅŸÑ€í ÿÆ€åÿßŸÑÿßÿ™:',
            '⁄©ÿ≥€å ÿß€åÿ≥€í ÿ¥ÿÆÿµ ⁄©€í ÿ≥ÿßÿ™⁄æ ÿ®ÿ≠ÿ´ ÿ¨Ÿà ÿ¢Ÿæ ÿ≥€í ŸÖÿ™ŸÅŸÇ ŸÜ€Å€å⁄∫€î ÿ¢Ÿæ:'
        ];
        
        // Store original English options for all questions
        const ENGLISH_OPTIONS = PHASE1_QUESTIONS.map(q => q.options.map(opt => opt.text));
        
        // Urdu translations for all options
        const URDU_OPTIONS = [
            // Q1: Salary/Gaza appeal
            ['ŸÅŸàÿ±€å ÿ∑Ÿàÿ± Ÿæÿ± ŸÜÿ∏ÿ± ÿßŸÜÿØÿßÿ≤ ⁄©ÿ± ÿØ€å⁄∫', 'ÿ≥Ÿà⁄Ü€å⁄∫ "ÿ®ÿπÿØ ŸÖ€å⁄∫ ÿπÿ∑€å€Å ÿØŸà⁄∫ ⁄Øÿß" ŸÑ€å⁄©ŸÜ ÿ®⁄æŸàŸÑ ÿ¨ÿßÿ¶€å⁄∫', 'ÿßŸÜ ŸÖÿ≥ŸÑÿ≥ŸÑ ÿßŸæ€åŸÑŸà⁄∫ ÿ≥€í Ÿæÿ±€åÿ¥ÿßŸÜ ŸÖÿ≠ÿ≥Ÿàÿ≥ ⁄©ÿ±€å⁄∫', 'ŸÇÿµŸàÿ±Ÿàÿßÿ± ŸÖÿ≠ÿ≥Ÿàÿ≥ ⁄©ÿ±€å⁄∫ ŸÑ€å⁄©ŸÜ ⁄©⁄Ü⁄æ ŸÜ€Å ⁄©ÿ±€å⁄∫', '⁄©⁄Ü⁄æ ÿπÿ∑€å€Å ⁄©ÿ±€å⁄∫ÿå ⁄Üÿß€Å€í ⁄Ü⁄æŸàŸπÿß €Å€å €ÅŸà', 'ŸÅŸàÿ±ÿßŸã ÿ¥⁄©ÿ± ⁄Øÿ≤ÿßÿ±€å ⁄©€í ÿ≥ÿßÿ™⁄æ ÿÆ€åÿ±ÿßÿ™ ÿØ€å⁄∫'],
            // Q2: Restaurant bill
            ['ÿßŸæŸÜ€í ÿ®€åŸÜ⁄© ÿ®€åŸÑŸÜÿ≥ ⁄©€å ŸÅ⁄©ÿ± ⁄©ÿ±€å⁄∫ ÿ≠ÿßŸÑÿßŸÜ⁄©€Å ÿ¢Ÿæ ÿ®ÿ±ÿØÿßÿ¥ÿ™ ⁄©ÿ± ÿ≥⁄©ÿ™€í €Å€å⁄∫', 'ÿßŸæŸÜÿß ÿ≠ÿµ€Å Ÿπ⁄æ€å⁄© Ÿπ⁄æ€å⁄© ÿ≠ÿ≥ÿßÿ® ⁄©ÿ±€å⁄∫ ÿ™ÿß⁄©€Å ÿ≤€åÿßÿØ€Å ÿßÿØÿß ŸÜ€Å ⁄©ÿ±€å⁄∫', 'ŸÜÿßÿ±ÿßÿ∂ €ÅŸà⁄∫ ⁄©€Å ÿßÿ™ŸÜÿß ÿÆÿ±⁄Ü ⁄©ÿ±ŸÜÿß Ÿæ⁄ë ÿ±€Åÿß €Å€í', 'Ÿπ⁄æ€å⁄© €Å€í ŸÑ€å⁄©ŸÜ ÿßŸÖ€åÿØ €Å€í ⁄©€Å ⁄©Ÿàÿ¶€å ÿßŸàÿ± ÿßÿØÿß ⁄©ÿ±ŸÜ€í ⁄©€å Ÿæ€åÿ¥⁄©ÿ¥ ⁄©ÿ±€í', 'ŸÖŸÜÿµŸÅÿßŸÜ€Å ÿ∑ÿ±€åŸÇ€í ÿ≥€í ÿ™ŸÇÿ≥€åŸÖ ⁄©ÿ±€å⁄∫ ÿ®ÿ∫€åÿ± ÿ™ŸÜÿßÿ§ ⁄©€í', 'ÿµÿØŸÇ€Å ⁄©€í ÿ∑Ÿàÿ± Ÿæÿ± ÿ≥ÿ® ⁄©€í ŸÑ€å€í ÿßÿØÿß ⁄©ÿ±ŸÜ€í ⁄©€å Ÿæ€åÿ¥⁄©ÿ¥ ⁄©ÿ±€å⁄∫'],
            // Q3: New car/phone/house
            ['ÿ¥ÿØÿ™ ÿ≥€í ÿÆŸàÿß€Åÿ¥ ⁄©ÿ±€å⁄∫ ⁄©€Å ⁄©ÿßÿ¥ ÿ¢Ÿæ ⁄©€í Ÿæÿßÿ≥ €ÅŸàÿ™ÿß', 'ÿ≠ÿ≥ÿßÿ® ŸÑ⁄Øÿßÿ¶€å⁄∫ ⁄©€Å ÿ¢Ÿæ €å€Å€å ⁄Ü€åÿ≤ ⁄©€åÿ≥€í ÿÆÿ±€åÿØ ÿ≥⁄©ÿ™€í €Å€å⁄∫', 'ÿßŸæŸÜ€å ⁄Ü€åÿ≤Ÿà⁄∫ ⁄©€í ÿ®ÿßÿ±€í ŸÖ€å⁄∫ ⁄©ŸÖ ŸÖÿ≠ÿ≥Ÿàÿ≥ ⁄©ÿ±€å⁄∫', 'ÿ≥Ÿà⁄Ü€å⁄∫ ⁄©€Å ÿßŸÜ ⁄©€í Ÿæÿßÿ≥ €Å€í ÿßŸàÿ± ÿ¢Ÿæ ⁄©€í Ÿæÿßÿ≥ ⁄©€åŸà⁄∫ ŸÜ€Å€å⁄∫', 'ÿßŸÜ ⁄©€í ŸÑ€å€í ÿÆŸàÿ¥ €ÅŸà⁄∫ÿå ÿßŸæŸÜ€í ÿ®ÿßÿ±€í ŸÖ€å⁄∫ ÿ∫€åÿ± ÿ¨ÿßŸÜÿ®ÿØÿßÿ±', 'ÿßŸÜ ⁄©€í ŸÑ€å€í ÿÆŸàÿ¥ €ÅŸà⁄∫ÿå ÿßŸæŸÜ€å ⁄Ü€åÿ≤Ÿà⁄∫ Ÿæÿ± ÿ¥⁄©ÿ± ⁄Øÿ≤ÿßÿ±'],
            // Q4: Mistake pointed out
            ['ÿØŸÅÿßÿπ€å €ÅŸà ÿ¨ÿßÿ¶€å⁄∫ ÿßŸàÿ± ÿ®ÿ≠ÿ´ ⁄©ÿ±€å⁄∫ ⁄©€Å ÿ¢Ÿæ ÿµÿ≠€åÿ≠ €Å€å⁄∫', 'ÿπÿ∞ÿ± ÿ®ŸÜÿßÿ¶€å⁄∫ €åÿß ÿ≠ÿßŸÑÿßÿ™ ⁄©Ÿà ÿßŸÑÿ≤ÿßŸÖ ÿØ€å⁄∫', 'ÿ¥ÿ±ŸÖŸÜÿØ€Å ŸÖÿ≠ÿ≥Ÿàÿ≥ ⁄©ÿ±€å⁄∫ ÿßŸàÿ± ÿßŸÜÿØÿ± ÿ≥€í ÿ∫ÿµ€í ŸÖ€å⁄∫ ÿ¢ ÿ¨ÿßÿ¶€å⁄∫', 'ÿÆÿßŸÖŸàÿ¥€å ÿ≥€í ŸÜÿ∏ÿ± ÿßŸÜÿØÿßÿ≤ ⁄©ÿ±€å⁄∫ ŸÑ€å⁄©ŸÜ ⁄©€åŸÜ€Å ÿ±⁄©⁄æ€å⁄∫', 'ÿ®ÿ±ÿß ŸÖÿ≠ÿ≥Ÿàÿ≥ ⁄©ÿ±€å⁄∫ ŸÑ€å⁄©ŸÜ ŸÇÿ®ŸàŸÑ ⁄©ÿ±€å⁄∫', 'ÿßŸÜ ⁄©ÿß ÿ¥⁄©ÿ±€å€Å ÿßÿØÿß ⁄©ÿ±€å⁄∫ ÿßŸàÿ± ŸÅŸàÿ±€å ÿ∑Ÿàÿ± Ÿæÿ± ÿØÿ±ÿ≥ÿ™ ⁄©ÿ±€å⁄∫'],
            // Q5: Help nobody knows
            ['ŸÜÿßÿ±ÿßÿ∂ ⁄©€Å ⁄©ÿ≥€å ŸÜ€í ŸÜ€Å€å⁄∫ ÿØ€å⁄©⁄æÿß', 'ÿßÿ≥ ⁄©ÿß "ÿßÿ™ŸÅÿßŸÇ€å" ÿ∑Ÿàÿ± Ÿæÿ± ÿØŸàÿ≥ÿ±Ÿà⁄∫ ÿ≥€í ÿ∞⁄©ÿ± ⁄©ÿ±ŸÜ€í ⁄©€å ÿÆŸàÿß€Åÿ¥', 'ÿßŸÖ€åÿØ ⁄©€Å Ÿà€Å ⁄©ŸÖ ÿßÿ≤ ⁄©ŸÖ ÿØŸàÿ≥ÿ±Ÿà⁄∫ ⁄©Ÿà ÿ®ÿ™ÿßÿ¶€å⁄∫', '⁄©ÿßÿ¥ ⁄©Ÿàÿ¶€å ⁄ØŸàÿß€Å €ÅŸàÿ™ÿß', 'ŸÖÿ∑ŸÖÿ¶ŸÜÿå ÿ™⁄æŸà⁄ë€å ÿ≥€å Ÿæ€Å⁄ÜÿßŸÜ ⁄©€å ÿÆŸàÿß€Åÿ¥ ⁄©€í ÿ≥ÿßÿ™⁄æ', 'ÿÆÿßŸÑÿµ ÿßÿ∑ŸÖ€åŸÜÿßŸÜ ÿ¢Ÿæ ÿßŸàÿ± ÿßŸÑŸÑ€Å ⁄©€í ÿØÿ±ŸÖ€åÿßŸÜ'],
            // Q6: Security guard/cleaner
            ['ÿßŸæŸÜ€å ÿ≠€åÿ´€åÿ™/ÿ∑ÿßŸÇÿ™ ⁄©ÿß ÿßÿ≥ÿ™ÿπŸÖÿßŸÑ ⁄©ÿ± ⁄©€í ÿ®ÿØŸÑ€Å ŸÑ€å⁄∫', 'ÿßŸÜ ⁄©€í ÿßŸÅÿ≥ÿ± ÿ≥€í ÿ¥⁄©ÿß€åÿ™ ⁄©ÿ±€å⁄∫ ÿ™ÿß⁄©€Å ÿßŸÜ€Å€å⁄∫ ŸÖÿµ€åÿ®ÿ™ ŸÖ€å⁄∫ ⁄àÿßŸÑ€å⁄∫', 'ÿ®ÿ≠ÿ´ ⁄©ÿ±€å⁄∫ ÿßŸàÿ± ÿßŸÜ€Å€å⁄∫ ⁄Ü⁄æŸàŸπÿß ŸÖÿ≠ÿ≥Ÿàÿ≥ ⁄©ÿ±ÿßÿ¶€å⁄∫', 'ÿ∫ÿµ€í ŸÖ€å⁄∫ €ÅŸà⁄∫ÿå ÿ®ÿπÿØ ŸÖ€å⁄∫ ÿØŸàÿ≥ÿ™Ÿà⁄∫ ÿ≥€í ÿ¥⁄©ÿß€åÿ™ ⁄©ÿ±€å⁄∫', '⁄Ü⁄æŸà⁄ë ÿØ€å⁄∫ ŸÑ€å⁄©ŸÜ ÿßŸÜÿØÿ± ÿ≥€í Ÿæÿ±€åÿ¥ÿßŸÜ', 'ÿµÿ®ÿ± ÿßŸàÿ± ŸÖ€Åÿ±ÿ®ÿßŸÜ€å ÿ≥€í ÿ¨Ÿàÿßÿ® ÿØ€å⁄∫'],
            // Q7: Friend 4x salary
            ['⁄©€åŸà⁄∫ ÿßŸÜ€Å€å⁄∫ ŸÖŸÑ€å ÿßŸàÿ± ŸÖÿ¨⁄æ€í ŸÜ€Å€å⁄∫ÿü', '⁄©ÿßÿ¥ Ÿà€Å ÿßÿ≥€í ⁄©⁄æŸà ÿØ€åÿ™€í', 'ÿ≠ÿ≥ÿØ ŸÖÿ≠ÿ≥Ÿàÿ≥ ⁄©ÿ±€å⁄∫ÿå ⁄©Ÿàÿ¥ÿ¥ ⁄©ÿ±€å⁄∫ ⁄Ü⁄æŸæÿßŸÜ€í ⁄©€å', 'ÿÆŸàÿ¥ €ÅŸà⁄∫ ŸÑ€å⁄©ŸÜ ÿ™⁄æŸà⁄ëÿß ÿ≠ÿ≥ÿØ ÿ®⁄æ€å', 'ŸàÿßŸÇÿπ€å ÿÆŸàÿ¥ÿå ⁄©Ÿàÿ¶€å ÿ≠ÿ≥ÿØ ŸÜ€Å€å⁄∫', 'ÿßŸÜ ⁄©€å ⁄©ÿßŸÖ€åÿßÿ®€å Ÿæÿ± ÿßŸÑŸÑ€Å ⁄©ÿß ÿ¥⁄©ÿ± ÿßÿØÿß ⁄©ÿ±€å⁄∫'],
            // Q8: Lies/harm months later
            ['ÿßŸÜÿ™ŸÇÿßŸÖ ⁄©€í ŸÖŸÜÿµŸàÿ®€í ÿ®ŸÜÿßÿ™€í €Å€å⁄∫', '⁄©€åŸÜ€Å ÿ±⁄©⁄æÿ™€í €Å€å⁄∫ÿå ŸÖÿπÿßŸÅ€å ÿ≥€í ÿßŸÜ⁄©ÿßÿ±', 'ÿßŸÜ€Å€å⁄∫ ŸÜÿßŸæÿ≥ŸÜÿØ ⁄©ÿ±ÿ™€í €Å€å⁄∫ÿå ÿ®ÿßÿ™Ÿà⁄∫ ŸÖ€å⁄∫ ÿ®ÿ±ÿßÿ¶€å ⁄©ÿ±ÿ™€í €Å€å⁄∫', 'ÿ®ÿ±ÿß ŸÖÿ≠ÿ≥Ÿàÿ≥ ⁄©ÿ±ÿ™€í €Å€å⁄∫ ŸÑ€å⁄©ŸÜ ÿ¢⁄Ø€í ÿ®⁄ë⁄æŸÜ€í ⁄©€å ⁄©Ÿàÿ¥ÿ¥', 'ŸÖÿπÿßŸÅ ⁄©ÿ± ÿØ€åÿßÿå ŸÜŸÅÿ±ÿ™ ÿÆÿ™ŸÖ €ÅŸà ⁄Øÿ¶€å', 'ÿßŸÜ ⁄©€í ŸÑ€å€í ÿØÿπÿß ⁄©ÿ±ÿ™€í €Å€å⁄∫ ÿßŸàÿ± ÿ®⁄æŸÑÿßÿ¶€å ⁄Üÿß€Åÿ™€í €Å€å⁄∫'],
            // Q9: Insincere apology
            ['ÿßŸÜ Ÿæÿ± ÿ≠ŸÖŸÑ€Å ⁄©ÿ±€å⁄∫ÿå ŸÖÿπÿßŸÅ€å ŸÖÿ≥ÿ™ÿ±ÿØ ⁄©ÿ±€å⁄∫', 'ÿ≥ÿ±ÿØ ÿ±Ÿà€å€Å ÿ±⁄©⁄æ€å⁄∫ÿå ÿßŸÜ ÿ≥€í ÿ®ÿßÿ™ ŸÜ€Å ⁄©ÿ±€å⁄∫', 'Ÿπ⁄æŸÜ⁄à€í ÿßŸÜÿØÿßÿ≤ ŸÖ€å⁄∫ ŸÇÿ®ŸàŸÑ ⁄©ÿ±€å⁄∫ÿå ÿßŸÜÿØÿ± ÿ≥€í ŸÜÿßÿ±ÿßÿ∂', 'ŸÇÿ®ŸàŸÑ ⁄©ÿ±€å⁄∫ ŸÑ€å⁄©ŸÜ ŸÅÿßÿµŸÑ€Å ÿ®ÿ±ŸÇÿ±ÿßÿ± ÿ±⁄©⁄æ€å⁄∫', 'ŸÖÿπÿßŸÅ ⁄©ÿ±€å⁄∫ÿå ÿ™ÿπŸÑŸÇ ÿ®ÿ≠ÿßŸÑ ⁄©ÿ±€å⁄∫', 'ÿÆŸÑŸàÿµ ÿ≥€í ŸÖÿπÿßŸÅ ⁄©ÿ±€å⁄∫ÿå ÿßŸÜ€Å€å⁄∫ ⁄ØŸÑ€í ŸÑ⁄Øÿßÿ¶€å⁄∫'],
            // Q10: Temptation phone/computer
            ['ÿ®ÿ∫€åÿ± ŸÖÿ≤ÿßÿ≠ŸÖÿ™ ŸÅŸàÿ±€å ÿ∑Ÿàÿ± Ÿæÿ± €Åÿßÿ± ŸÖÿßŸÜ ŸÑ€å⁄∫', 'ŸÖÿ≤ÿßÿ≠ŸÖÿ™ ⁄©€å ⁄©Ÿàÿ¥ÿ¥ ⁄©ÿ±€å⁄∫ ŸÑ€å⁄©ŸÜ ÿπÿßŸÖ ÿ∑Ÿàÿ± Ÿæÿ± ŸÜÿß⁄©ÿßŸÖ', 'ÿ¨ÿØŸàÿ¨€ÅÿØ ⁄©ÿ±€å⁄∫ ŸÑ€å⁄©ŸÜ ÿ¢ÿÆÿ± ⁄©ÿßÿ± €Åÿßÿ± ŸÖÿßŸÜ ŸÑ€å⁄∫', 'ŸÖÿ≤ÿßÿ≠ŸÖÿ™ ⁄©ÿ±€å⁄∫ ŸÑ€å⁄©ŸÜ ÿßÿ≥ ⁄©€í ÿ®ÿßÿ±€í ŸÖ€å⁄∫ ÿ≥Ÿà⁄Üÿ™€í ÿ±€Å€å⁄∫', 'ÿ≤€åÿßÿØ€Å ÿ™ÿ± ÿ®ÿßÿ± ⁄©ÿßŸÖ€åÿßÿ®€å ÿ≥€í ÿßŸæŸÜ€å ÿ™Ÿàÿ¨€Å €ÅŸπÿßÿ¶€å⁄∫', 'ŸÅŸàÿ±€å ÿ∑Ÿàÿ± Ÿæÿ± ÿ®ŸÜÿØ ⁄©ÿ±€å⁄∫ ÿßŸàÿ± ÿßŸÑŸÑ€Å ⁄©€å ŸæŸÜÿß€Å ŸÖÿßŸÜ⁄Ø€å⁄∫'],
            // Q11: Fajr alarm
            ['ÿßŸÑÿßÿ±ŸÖ ÿ®ŸÜÿØ ⁄©ÿ±€å⁄∫ÿå ÿ≥Ÿàÿ™€í ÿ±€Å€å⁄∫', 'ÿ®ÿßÿ± ÿ®ÿßÿ± ÿ≥ŸÜŸàÿ≤ ⁄©ÿ±€å⁄∫ÿå ÿπÿßŸÖ ÿ∑Ÿàÿ± Ÿæÿ± ⁄Ü⁄æŸà⁄ë ÿØ€å⁄∫', 'ÿßŸÜÿØÿ±ŸàŸÜ€å ÿ¨ŸÜ⁄Øÿå 50% ŸàŸÇÿ™ ⁄Ü⁄æŸà⁄ë ÿØ€å⁄∫', 'ÿÆŸàÿØ ⁄©Ÿà ÿßŸπ⁄æÿßÿ¶€å⁄∫ ŸÑ€å⁄©ŸÜ ŸÜÿßÿ±ÿßÿ∂ ŸÖÿ≠ÿ≥Ÿàÿ≥ ⁄©ÿ±€å⁄∫', 'ÿßŸπ⁄æ ÿ¨ÿßÿ¶€å⁄∫ ŸÑ€å⁄©ŸÜ €Åÿ± ÿ®ÿßÿ± ÿ¨ÿØŸàÿ¨€ÅÿØ ⁄©ÿ±€å⁄∫', 'ÿ¥⁄©ÿ± ⁄Øÿ≤ÿßÿ±€å ⁄©€í ÿ≥ÿßÿ™⁄æ ŸÅŸàÿ±€å ÿ∑Ÿàÿ± Ÿæÿ± ÿß⁄Ü⁄æŸÑ ⁄©ÿ± ÿßŸπ⁄æ€å⁄∫'],
            // Q12: Death/funeral
            ['ŸÅÿπÿßŸÑ ÿ∑Ÿàÿ± Ÿæÿ± ÿßÿ≥ ⁄©€í ÿ®ÿßÿ±€í ŸÖ€å⁄∫ ÿ≥Ÿà⁄ÜŸÜ€í ÿ≥€í ⁄Øÿ±€åÿ≤ ⁄©ÿ±€å⁄∫', 'Ÿæÿ±€åÿ¥ÿßŸÜ €ÅŸà ÿ¨ÿßÿ¶€å⁄∫ ÿßŸàÿ± ŸÖŸàÿ∂Ÿàÿπ ÿ®ÿØŸÑ ÿØ€å⁄∫', 'ÿ®€í ⁄Ü€åŸÜÿå ÿÆŸàÿØ ⁄©Ÿà ŸÖÿ¥ÿ∫ŸàŸÑ ⁄©ÿ±ŸÜ€í ⁄©€å ⁄©Ÿàÿ¥ÿ¥', 'ÿ™⁄æŸà⁄ëÿß ÿ≥ÿß ÿ∫Ÿàÿ±ÿå Ÿæ⁄æÿ± ÿ®⁄æŸàŸÑ ÿ¨ÿßÿ¶€å⁄∫', 'ÿ∫Ÿàÿ± ⁄©ÿ±€å⁄∫ ŸÑ€å⁄©ŸÜ Ÿæ⁄æÿ± ŸÖÿπŸÖŸàŸÑ Ÿæÿ± ŸÑŸàŸπ ÿ¢ÿ¶€å⁄∫', '⁄Ø€Åÿ±ÿß ÿ∫Ÿàÿ± ÿßŸàÿ± ÿßŸæŸÜ€í ÿßÿπŸÖÿßŸÑ ⁄©Ÿà ÿ¨ÿßŸÜ⁄Ü€å⁄∫'],
            // Q13: During prayer
            ['ŸÖ⁄©ŸÖŸÑ ÿ∑Ÿàÿ± Ÿæÿ± ⁄©€Å€å⁄∫ ÿßŸàÿ±ÿå ÿ®ŸÖÿ¥⁄©ŸÑ €åÿßÿØ ⁄©€Å ŸÜŸÖÿßÿ≤ Ÿæ⁄ë⁄æ ÿ±€Å€í €Å€å⁄∫', 'ÿ≤€åÿßÿØ€Å ÿ™ÿ± ÿØŸÜ€åÿßŸà€å ŸÖÿπÿßŸÖŸÑÿßÿ™ ŸÖ€å⁄∫ ÿ≥Ÿà⁄Ü ÿ±€Åÿß €Å€í', 'ÿ™Ÿàÿ¨€Å ÿØ€åŸÜ€í ⁄©€å ⁄©Ÿàÿ¥ÿ¥ ŸÑ€å⁄©ŸÜ ŸÖÿ≥ŸÑÿ≥ŸÑ ÿ®⁄æŸπ⁄© ÿ±€Åÿß €Å€í', '⁄©⁄Ü⁄æ ÿ≠ÿßÿ∂ÿ±€åÿå ⁄©⁄Ü⁄æ ÿ®⁄æŸπ⁄©ÿßÿ§', 'ÿ≤€åÿßÿØ€Å ÿ™ÿ± ÿ≠ÿßÿ∂ÿ±ÿå ⁄©ÿ®⁄æ€å ⁄©ÿ®⁄æÿßÿ± ÿ®⁄æŸπ⁄©ŸÜÿß', 'ÿßŸÑŸÑ€Å ⁄©€í ÿ≥ÿßÿ™⁄æ ŸÖ⁄©ŸÖŸÑ ÿ∑Ÿàÿ± Ÿæÿ± ÿ≠ÿßÿ∂ÿ±'],
            // Q14: Major setback
            ['ÿßŸÑŸÑ€Å ŸÖ€åÿ±€í ÿ≥ÿßÿ™⁄æ €å€Å ⁄©€åŸà⁄∫ ⁄©ÿ± ÿ±€Åÿß €Å€íÿü', 'ŸÖ€å⁄∫ ÿßÿ≥ ⁄©ÿß ŸÖÿ≥ÿ™ÿ≠ŸÇ ŸÜ€Å€å⁄∫ÿå ÿßŸÑŸÑ€Å ŸÜÿßÿßŸÜÿµÿßŸÅ€å ⁄©ÿ± ÿ±€Åÿß €Å€í', 'ŸÖ€å⁄∫ ŸÜ€í ⁄©€åÿß ⁄©€åÿß ⁄©€Å €å€Å ŸÖÿ≥ÿ™ÿ≠ŸÇ €ÅŸà⁄∫ÿü (ÿßŸÑÿ≤ÿßŸÖ)', 'ÿ≥ÿ® ÿ≥€í ÿßŸæŸÜ€å ÿ®ÿØ ŸÇÿ≥ŸÖÿ™€å ⁄©€å ÿ¥⁄©ÿß€åÿ™ ⁄©ÿ±€å⁄∫', 'ÿßÿØÿßÿ≥ ŸÑ€å⁄©ŸÜ ŸÇÿ®ŸàŸÑ ⁄©ÿ±ŸÜ€í ⁄©€å ⁄©Ÿàÿ¥ÿ¥', 'ÿßŸÑÿ≠ŸÖÿØ ŸÑŸÑ€Åÿå ÿßŸÑŸÑ€Å ⁄©€å ÿ≠⁄©ŸÖÿ™ Ÿæÿ± ÿ®⁄æÿ±Ÿàÿ≥€Å'],
            // Q15: Crisis urgent help
            ['ŸÅŸàÿ±€å ÿ∑Ÿàÿ± Ÿæÿ± ŸÑŸà⁄ØŸà⁄∫ ⁄©Ÿà ŸÖÿØÿØ ⁄©€í ŸÑ€å€í ŸÅŸàŸÜ ⁄©ÿ±€å⁄∫', '⁄Ø⁄æÿ®ÿ±ÿßÿ¶€å⁄∫ ÿßŸàÿ± ÿ≥Ÿà⁄Ü€å⁄∫ ⁄©€Å ⁄©ŸàŸÜ ŸÖÿØÿØ ⁄©ÿ± ÿ≥⁄©ÿ™ÿß €Å€í', 'Ÿæ€ÅŸÑ€í ÿÆŸàÿØ Ÿπ⁄æ€å⁄© ⁄©ÿ±ŸÜ€í ⁄©€å ⁄©Ÿàÿ¥ÿ¥ ⁄©ÿ±€å⁄∫', 'ŸÑŸà⁄ØŸà⁄∫ ÿ≥€í ŸæŸà⁄Ü⁄æ€å⁄∫ Ÿæ⁄æÿ± ÿßŸÑŸÑ€Å ⁄©Ÿà €åÿßÿØ ⁄©ÿ±€å⁄∫', 'ÿ¨ŸÑÿØ€å ÿ≥€í ÿØÿπÿß ⁄©ÿ±€å⁄∫ Ÿæ⁄æÿ± ÿπŸÖŸÑ ⁄©ÿ±€å⁄∫', 'Ÿæ€ÅŸÑ€í ÿßŸÑŸÑ€Å ⁄©€å ÿ∑ÿ±ŸÅ ÿ±ÿ¨Ÿàÿπ ⁄©ÿ±€å⁄∫ÿå Ÿæ⁄æÿ± Ÿàÿ≥ÿßÿ¶ŸÑ ÿßÿ≥ÿ™ÿπŸÖÿßŸÑ ⁄©ÿ±€å⁄∫'],
            // Q16: Traffic/rude push
            ['ŸÅŸàÿ±€å ÿ∑Ÿàÿ± Ÿæÿ± ÿ∫ÿµ€í ŸÖ€å⁄∫ Ÿæ⁄æŸπ ÿ¨ÿßÿ¶€å⁄∫/⁄ØÿßŸÑ€å ÿØ€å⁄∫', 'ÿ®€Åÿ™ ÿ∫ÿµ€í ŸÖ€å⁄∫ ÿ¢ÿ¶€å⁄∫ÿå ÿ¨ÿßÿ±ÿ≠ÿßŸÜ€Å ÿ∑Ÿàÿ± Ÿæÿ± ŸÖŸÇÿßÿ®ŸÑ€Å ⁄©ÿ±€å⁄∫', 'ÿßŸÜÿØÿ± ÿ≥€í ÿ∫ÿµ€í ŸÖ€å⁄∫ÿå ŸÖÿÆÿßÿµŸÖÿßŸÜ€Å ÿßÿ¥ÿßÿ±€í ⁄©ÿ±€å⁄∫', 'ŸÜÿßÿ±ÿßÿ∂ÿå ÿ®⁄ëÿ®⁄ëÿßÿ™€í €ÅŸàÿ¶€í ÿ¥⁄©ÿß€åÿ™ ⁄©ÿ±€å⁄∫', 'ŸÖÿß€åŸàÿ≥ ŸÑ€å⁄©ŸÜ ÿ∏ÿß€Åÿ±€å ÿ∑Ÿàÿ± Ÿæÿ± Ÿæÿ±ÿ≥⁄©ŸàŸÜ ÿ±€Å€å⁄∫', 'Ÿæÿ±ÿ≥⁄©ŸàŸÜ ÿ±€Å€å⁄∫ÿå ÿß⁄Ü⁄æ€å Ÿàÿ¨€Å ŸÅÿ±ÿ∂ ⁄©ÿ±€å⁄∫'],
            // Q17: Monday morning
            ['€å€Å ÿØŸÜ ÿÆŸàŸÅŸÜÿß⁄© €ÅŸà ⁄Øÿß', '€å€Åÿß⁄∫ €ÅŸÖ Ÿæ⁄æÿ± ÿ≥€í €Å€å⁄∫ÿå Ÿà€Å€å ŸÖÿ≥ÿßÿ¶ŸÑ', 'ŸÅ⁄©ÿ± ŸÖŸÜÿØ ⁄©€Å ⁄©€åÿß ÿ∫ŸÑÿ∑ €ÅŸà ÿ≥⁄©ÿ™ÿß €Å€í', 'ÿ∫€åÿ± ÿ¨ÿßŸÜÿ®ÿØÿßÿ±ÿå ÿ¨€åÿ≥ÿß ÿ¢ÿ¶€í ŸÑ€í ŸÑ€å⁄∫ ⁄Ø€í', 'ÿßŸÖ€åÿØ ŸÖŸÜÿØ ŸÑ€å⁄©ŸÜ ŸÖÿ≠ÿ™ÿßÿ∑', 'ŸÜÿ¶€í ÿØŸÜ ⁄©€í ŸÑ€å€í ÿ¥⁄©ÿ± ⁄Øÿ≤ÿßÿ±ÿå Ÿæÿ± ÿßŸÖ€åÿØ'],
            // Q18: Disagree discussion
            ['€Åÿ± ŸÇ€åŸÖÿ™ Ÿæÿ± ÿ¨€åÿ™ŸÜÿß ÿ∂ÿ±Ÿàÿ±€åÿå ÿ¨ÿßÿ±ÿ≠ÿßŸÜ€Å €ÅŸà ÿ¨ÿßÿ¶€å⁄∫', 'ÿ¥ÿØÿ™ ÿ≥€í ÿ®ÿ≠ÿ´ ⁄©ÿ±€å⁄∫ÿå ÿßŸÜ€Å€å⁄∫ ÿµÿ≠€åÿ≠ ŸÜ€Å€å⁄∫ €ÅŸàŸÜ€í ÿØ€í ÿ≥⁄©ÿ™€í', 'ÿßŸæŸÜ€å ÿ®ÿßÿ™ ÿ®ÿßÿ± ÿ®ÿßÿ± ÿØ€Åÿ±ÿßÿ™€í ÿ±€Å€å⁄∫', 'ÿ®ÿ≠ÿ´ ⁄©ÿ±€å⁄∫ ŸÑ€å⁄©ŸÜ ÿ∂ÿ±Ÿàÿ±ÿ™ Ÿæ⁄ë€í ÿ™Ÿà ÿ±⁄©ŸÜ€í ⁄©Ÿà ÿ™€åÿßÿ±', 'ÿ≥ŸÖÿ¨⁄æŸÜ€í ⁄©€í ŸÑ€å€í ÿ®ÿßÿ™ ⁄©ÿ±€å⁄∫ÿå ÿ¨€åÿ™ŸÜ€í ⁄©€í ŸÑ€å€í ŸÜ€Å€å⁄∫', 'ÿ≠ŸÇ€åŸÇ€å ÿ∑Ÿàÿ± Ÿæÿ± ÿ≥ŸÜ€å⁄∫ÿå ÿ∫ŸÑÿ∑ €ÅŸàŸÜ€í ⁄©Ÿà ÿ™€åÿßÿ±']
        ];
        
        // Current language state
        let isUrdu = false;
        
        // Get button
        const urduBtn = document.getElementById('urduBtn');
        
        // Toggle function
        urduBtn.onclick = function() {
            isUrdu = !isUrdu;
            
            if (isUrdu) {
                // Switch to Urdu
                urduBtn.textContent = 'English';
                document.body.style.direction = 'rtl';
                document.body.style.fontFamily = "'Noto Nastaliq Urdu', serif";
                document.querySelector('.subtitle').textContent = 'ÿ±Ÿàÿ≠ÿßŸÜ€å ŸÇŸÑÿ® ⁄©€å ÿµÿ≠ÿ™ ⁄©ÿß ÿ¨ÿßÿ¶ÿ≤€Å';
                
                // Update welcome screen
                const welcomeTitle = document.getElementById('welcome-title');
                const hadithText = document.getElementById('hadith-text');
                const descriptionText = document.getElementById('description-text');
                const phasesText = document.getElementById('phases-text');
                const beginBtn = document.getElementById('begin-btn');
                
                if (welcomeTitle) welcomeTitle.textContent = 'ÿßŸæŸÜ€í ÿØŸÑ ⁄©€å ÿ≠ÿßŸÑÿ™ ÿØÿ±€åÿßŸÅÿ™ ⁄©ÿ±€å⁄∫';
                if (hadithText) hadithText.innerHTML = '"ÿ®€í ÿ¥⁄© ÿ¨ÿ≥ŸÖ ŸÖ€å⁄∫ ⁄ØŸàÿ¥ÿ™ ⁄©ÿß ÿß€å⁄© Ÿπ⁄©⁄ëÿß €Å€íÿå ÿ¨ÿ® €å€Å Ÿπ⁄æ€å⁄© €ÅŸà ÿ™Ÿà ÿ≥ÿßÿ±ÿß ÿ¨ÿ≥ŸÖ Ÿπ⁄æ€å⁄© €Å€íÿå ÿßŸàÿ± ÿ¨ÿ® €å€Å ÿÆÿ±ÿßÿ® €ÅŸà ÿ™Ÿà ÿ≥ÿßÿ±ÿß ÿ¨ÿ≥ŸÖ ÿÆÿ±ÿßÿ® €Å€í€î €åŸÇ€åŸÜÿßŸã €å€Å ÿØŸÑ €Å€í€î"<br><em style="color: var(--gold);">‚Äî ŸÜÿ®€å ŸÖÿ≠ŸÖÿØ Ô∑∫</em>';
                if (descriptionText) descriptionText.innerHTML = '€å€Å ŸÖŸàÿßŸÅŸÇÿ™ Ÿæÿ∞€åÿ± ÿ¨ÿßÿ¶ÿ≤€Å <strong>ÿ≠ŸÇ€åŸÇ€å ÿ≤ŸÜÿØ⁄Ø€å ⁄©€í ŸÖŸÜÿ∏ÿ±ŸÜÿßŸÖŸà⁄∫</strong> ⁄©Ÿà <strong>ÿßÿ≠ŸÖÿØ ÿ≤ÿ±ŸàŸÇ</strong> ÿßŸàÿ± <strong>ÿßŸÖÿßŸÖ ŸÖÿßŸàŸÑŸàÿØ</strong> ⁄©€å ÿ≠⁄©ŸÖÿ™ ⁄©€í ÿ≥ÿßÿ™⁄æ ŸÖŸÑÿß ⁄©ÿ± ÿ¢Ÿæ ⁄©€å ÿ±Ÿàÿ≠ÿßŸÜ€å ÿ®€åŸÖÿßÿ±€åŸà⁄∫ ⁄©€å ÿ¥ŸÜÿßÿÆÿ™ ÿßŸàÿ± ÿπŸÑÿßÿ¨ ŸÖ€å⁄∫ ŸÖÿØÿØ ⁄©ÿ±ÿ™ÿß €Å€í€î';
                if (phasesText) phasesText.innerHTML = 'ŸÅ€åÿ≤ 1: 18 ÿ≠ÿßŸÑÿßÿ™€å ÿ≥ŸàÿßŸÑÿßÿ™ (~10 ŸÖŸÜŸπ)<br>ŸÅ€åÿ≤ 2: ÿ∂ÿ±Ÿàÿ±ÿ™ Ÿæ⁄ëŸÜ€í Ÿæÿ± ⁄Ø€Åÿ±ÿßÿ¶€å ŸÖ€å⁄∫ ÿ¨ÿßÿ¶ÿ≤€Å (~10 ŸÖÿ≤€åÿØ ŸÖŸÜŸπ)<br>ÿ±ÿßÿ≤ÿØÿßÿ±€å: ÿ¢Ÿæ ⁄©€í ÿ¨Ÿàÿßÿ®ÿßÿ™ ÿ¢Ÿæ ⁄©€í ÿ¢ŸÑ€í Ÿæÿ± ŸÖÿ≠ŸÅŸàÿ∏ ÿ±€Åÿ™€í €Å€å⁄∫';
                if (beginBtn) beginBtn.textContent = 'ÿ¨ÿßÿ¶ÿ≤€Å ÿ¥ÿ±Ÿàÿπ ⁄©ÿ±€å⁄∫';
                
                // Update all Phase 1 questions - scenarios AND options
                for (let i = 0; i < 18; i++) {
                    PHASE1_QUESTIONS[i].scenario = URDU_SCENARIOS[i];
                    for (let j = 0; j < PHASE1_QUESTIONS[i].options.length; j++) {
                        PHASE1_QUESTIONS[i].options[j].text = URDU_OPTIONS[i][j];
                    }
                }
                
            } else {
                // Switch to English
                urduBtn.textContent = 'ÿßÿ±ÿØŸà';
                document.body.style.direction = 'ltr';
                document.body.style.fontFamily = "'Inter', sans-serif";
                document.querySelector('.subtitle').textContent = 'Spiritual Heart Health Assessment';
                
                // Restore welcome screen
                const welcomeTitle = document.getElementById('welcome-title');
                const hadithText = document.getElementById('hadith-text');
                const descriptionText = document.getElementById('description-text');
                const phasesText = document.getElementById('phases-text');
                const beginBtn = document.getElementById('begin-btn');
                
                if (welcomeTitle) welcomeTitle.textContent = 'Discover the State of Your Heart';
                if (hadithText) hadithText.innerHTML = '"Indeed, there is in the body a piece of flesh which, if sound, the entire body is sound, and if corrupt, the entire body is corrupt. Verily, it is the heart."<br><em style="color: var(--gold);">‚Äî Prophet Muhammad Ô∑∫</em>';
                if (descriptionText) descriptionText.innerHTML = 'This adaptive assessment uses <strong>real-life scenarios</strong> combined with the wisdom of <strong>Ahmad Zarruq</strong> and <strong>Imam Mawlud</strong> to help you identify and treat spiritual diseases.';
                if (phasesText) phasesText.innerHTML = 'Phase 1: 18 situational questions (~10 minutes)<br>Phase 2: Adaptive deep dive if needed (~10 more minutes)<br>Privacy: Your answers stay private on your device';
                if (beginBtn) beginBtn.textContent = 'Begin Assessment';
                
                // Restore English - scenarios AND options
                for (let i = 0; i < 18; i++) {
                    PHASE1_QUESTIONS[i].scenario = ENGLISH_SCENARIOS[i];
                    for (let j = 0; j < PHASE1_QUESTIONS[i].options.length; j++) {
                        PHASE1_QUESTIONS[i].options[j].text = ENGLISH_OPTIONS[i][j];
                    }
                }
            }
            
            // Re-render if in Phase 1
            if (currentPhase === 'phase1') {
                renderPhase1();
            }
        };
        
        // Check if running as PWA
        if (window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone === true) {
            console.log('üì± Running as installed PWA!');
        }
    </script>
</body>
</html>
